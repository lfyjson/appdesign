define("mobile/js/main",["./controller/load","./view/templates","./tools/method","./model/data","./model/search","../../config/config","./controller/watch","./controller/file-handler","./view/dialog","./tools/slide","./tools/base64","./controller/detail-handler","./controller/submit","./controller/validation","./model/approver","./controller/approver-handler","./tools/escape"],function(a){a("./controller/load").loadScript(),a("./tools/method"),a("./controller/watch").init()}),define("mobile/js/controller/approver-handler",["../view/templates","../tools/method","../model/data","../model/search","../../../config/config","../view/dialog","../model/approver"],function(a,b){var c=a("../view/templates"),d=(a("../model/data"),a("../model/search")),e=a("../view/dialog"),f=a("../tools/method"),g=a("../model/approver").approver,h={oSelected:document.querySelector(".approver-list"),oMain:document.getElementById("main"),addHanlder:function(){if(!this.wrap){var a=c.getWidget({type:"approverList"});this.wrap=f.parseDOM(a)[0],this.oList=this.wrap.querySelector(".select-approver-list"),this.hint=this.wrap.querySelector(".no-approver"),this.addListItem(),this.closeBtn=this.wrap.querySelector(".approver-getback"),this.closeBtn.on("tap",this.closeListHanlder.bind(this),!1),this.scrollTop=document.body.scrollTop,this.oMain.style.display="none",document.body.appendChild(this.wrap),document.body.scrollTop=0,this.input=this.wrap.querySelector(".approver-search-input"),i.init(this.oList,this.input,this.hint)}},closeListHanlder:function(){this.oMain.style.display="block",document.body.removeChild(this.wrap),document.body.scrollTop=this.scrollTop,this.wrap=null},addListItem:function(){if(this.arr=d.aApproverList,this.arr){for(var a=0;a<this.arr.length;a++)this.oList.innerHTML+=c.tApproverItem(this.arr[a].name,this.arr[a].personid);this.selectHanlder()}else this.hint.style.display="block",this.hint.innerHTML="没有可供选择的审批人"},selectHanlder:function(){var a=this;this.aA=this.oList.querySelectorAll("a");for(var b=0;b<this.aA.length;b++)this.aA[b].index=b,this.aA[b].addEventListener("click",function(b){var d=a.arr[this.index].name,h=a.arr[this.index].personid;if(a.closeListHanlder(),g.exists(h))e.tips({content:"该审批人已在列表中",time:1e3});else{var i=c.tSelectedApprover(d,h),j=f.parseDOM(i)[0],k=a.oSelected.querySelector("li");a.oSelected.insertBefore(j,k),g.add(d,h)}},!1)},delHanlder:function(a){g.del(a.dataset.personid),this.oSelected.removeChild(a.parentNode)}},i={init:function(a,b,c){this.oList=a,this.input=b,this.hint=c,this.aList=this.oList.getElementsByTagName("a"),this.input.addEventListener("input",this.filter.bind(this),!1)},filter:function(){for(var a=this.input.value,b=0,c=0;c<this.aList.length;c++)-1===this.aList[c].dataset.name.indexOf(a)?this.aList[c].style.display="none":(this.aList[c].style.display="block",b++);b>0?this.hint.style.display="none":(this.hint.style.display="block",this.hint.innerHTML="没有搜索到相关结果")}};b.approver=h}),define("mobile/js/controller/detail-handler",["../view/templates","../tools/method","../model/data","../view/dialog"],function(a,b,c){function d(a){for(var b=0;b<a.length;b++)a[b].innerHTML=b+1}var e=a("../view/templates"),f=a("../tools/method"),g={hanlder:function(b){var c=b.parentNode,g=a("../model/data").DATA,h=this.getData(g[0],b.dataset.id),i=g[b.dataset.id];if(null!=h){var j=e.tDetailInner(h.title,2,!0),k=f.parseDOM(j),l=k[0],m=k[1];c.insertBefore(l,b),c.insertBefore(m,b),d(c.querySelectorAll(".detail-num")),this.insertWidget(m,i)}},getData:function(a,b){for(var c=0;c<a.length;c++)if(a[c].id==b)return a[c];return null},insertWidget:function(a,b){for(var c=0;c<b.length;c++)a.innerHTML+=e.getWidget(b[c])}},h={handler:function(b){var c=this,d=a("../view/dialog").dialog({content:"你确定要删除吗？"});d.btnTrue.on("tap",function(){c.removeDetail(b)},!1)},removeDetail:function(a){var b=a.parentNode,c=b.nextElementSibling,e=b.parentNode;e.removeChild(b),e.removeChild(c),d(e.querySelectorAll(".detail-num"))}};b.add=g,b.del=h}),define("mobile/js/controller/file-handler",["../view/dialog","../../../config/config","../model/search","../tools/method","../tools/slide","../tools/base64"],function(a,b,c){var d=a("../view/dialog"),e=a("../../../config/config").Path,f=a("../model/search"),g=a("../tools/method");a("../tools/slide");var h={hanlder:function(b){var c=this,e=b.files[0];this.initLabel(b);var f=/^image/gi;return e&&f.test(e.type)?void a("../tools/base64").handler(e,function(a,b){var d=parseInt(1e10*Math.random()).toString(16);c.i=g.create("i"),c.i.dataset.action="delete-image",c.i.dataset.imgid=d,c.img=new Image,c.img.src=a,c.img.dataset.src=b,c.img.dataset.imgid=d,c.transfer(a,b,c.i.dataset.imgid,c.getSuffix(e.type))}):(d.tips({content:"请上传图片类型文件"}),void c.oList.removeChild(c.span))},getSuffix:function(a){var b=a.indexOf("/")+1;return a.substr(b)},initLabel:function(a){this.oList=a.parentNode.nextElementSibling,this.span=g.create("span"),this.em=g.create("em"),this.span.appendChild(this.em),this.oList.appendChild(this.span),this.span.style.height=this.span.offsetWidth+"px"},transfer:function(a,b,c,d){var h=this,i="action=upload&thumbbase64="+encodeURIComponent(a)+"&naturalbase64="+encodeURIComponent(b);i+="&picId="+c+"&"+f.sSearch,i+="&thumbsuffix="+d+"&naturalsuffix="+d,i+="&username=1&personid=2",g.ajax({type:"post",url:e.file,data:i,success:function(a){a=JSON.parse(a),console.log(a),200==a.status?h.success(a):h.error()},error:h.error.bind(h)})},success:function(a){a.thumbURL&&(this.img.src=a.thumbURL),a.naturalURL&&(this.img.dataset.src=a.naturalURL),this.span.removeChild(this.em),this.span.appendChild(this.img),this.span.appendChild(this.i)},error:function(){d.tips({content:"图片上传失败"}),this.oList.removeChild(this.span)}},i={hanlder:function(a){var b=this,c=a.previousElementSibling;b.target=a;var d="action=delete&id="+a.dataset.imgid+"&"+f.sSearch;d+="&thumbURL="+c.src+"&naturalURL="+c.dataset.src,console.log(d),g.ajax({type:"post",url:e.file,data:d,success:function(a){a=JSON.parse(a),b.success()},error:b.error})},success:function(){this.span=this.target.parentNode,this.oList=this.span.parentNode,this.oList.removeChild(this.span)},error:function(){d.tips({content:"图片删除失败"})}};b.upload=h,b.del=i}),define("mobile/js/controller/load",["../view/templates","../tools/method","../model/data","../model/search","../../../config/config"],function(a,b){function c(){g.oSearch&&"undefined"!==g.oSearch.tplid&&(d=document.createElement("script"),d.src=h.mobileDataPath+g.oSearch.tplid+".js",document.body.appendChild(d))}var d,e=a("../view/templates"),f=a("../model/data"),g=a("../model/search"),h=a("../../../config/config").Path,i=a("../tools/method");window.loadWidget=function(a){f.format(a);var b=f.DATA,c=b[-1][0].title;c&&(document.title=c);var g=b[0],h=e.getMain();document.body.appendChild(h);for(var j=0;j<g.length;j++){var k=i.parseDOM(e.getWidget(g[j]))[0];if(h.appendChild(k),"detail"==g[j].type)for(var l=k.querySelector(".detail-area"),m=b[g[j].id],n=0;n<m.length;n++){var o=e.getWidget(m[n]);l.innerHTML+=o}}d&&d.parentNode&&document.body.removeChild(d)},b.loadScript=c}),define("mobile/js/controller/submit",["./validation","../model/data","../view/dialog","../tools/method","../model/approver","../../../config/config","../model/search"],function(a,b){function c(){var a=h.check();if(a){var b=i.DATA[-1][0],c="&itemname="+(b.title?b.title:"暂无");c+="&itemdesc="+(b.explain?b.explain:"暂无");var g="data="+JSON.stringify(f())+"&"+l.sSearch;g+=c,g+="&urlprefix="+l.getUrlPrefix(),g+="&isvalid="+(b.enabled?1:0),g+=n.get(),g+="&iconurl="+b.iconURL,console.log(g),m.ajax({type:"post",url:k.submit,data:g,beforeSend:function(){j.tips({type:"loading",content:"正在努力提交中..."})},success:function(a){a=JSON.parse(a),console.log(a),200==a.status?d(a):e(a)},error:e})}}function d(a){j.tips({content:"提交成功",time:1500,onTimeEnd:function(){a.fdurl}})}function e(a){j.tips({content:a.msgdesc?a.msgdesc:"提交失败",time:1500})}function f(){var a=document.querySelectorAll('div[data-parentid="0"]');return g(a)}function g(a){for(var b={},c=0;c<a.length;c++){var d=a[c],e=i.DATA[d.dataset.parentid][d.dataset.order-1];o[e.type]&&(b[c+"."+e.type]=o[e.type](d,e))}return b}var h=a("./validation"),i=a("../model/data"),j=a("../view/dialog"),k=a("../../../config/config").Path,l=a("../model/search"),m=a("../tools/method"),n=a("../model/approver").approver,o={text:function(a,b){var c={},d=a.querySelector("[data-native]").value;return c[b.title]=d,c},textare:function(a,b){return this.text(a,b)},number:function(a,b){return this.text(a,b)},date:function(a,b){return this.text(a,b)},radio:function(a,b){var c={},d=a.querySelector("[data-native]");return d.dataset.enabled?c[b.title]=d.value:c[b.title]="",c},dateRange:function(a,b){var c={},d=a.querySelectorAll("[data-native]");return c[b.title]=d[0].value,c[b.title2]=d[1].value,c},image:function(a,b){for(var c={},d=a.querySelectorAll("img"),e=0;e<d.length;e++){var f={thumbURL:d[e].src,naturalURL:d[e].dataset.src};c[d[e].dataset.imgid]=f}return console.log(c),c},detail:function(a,b){for(var c={},d=a.querySelectorAll(".detail-area"),e=0;e<d.length;e++){var f=d[e].querySelectorAll("div[data-parentid]");c[b.title+"("+e+")"]=g(f)}return c}};b.submit=c}),define("mobile/js/controller/validation",["../model/data","../view/dialog","../tools/method","../model/approver"],function(a,b){function c(){for(var a=document.querySelectorAll("div[data-order]"),b=0;b<a.length;b++){var c,d=a[b],g=e.DATA[d.dataset.parentid][d.dataset.order-1];if(j[g.type]&&(c=j[g.type](d,g)),null!=c){f.tips({content:c,time:1500});break}}return h.toid.length<1&&!c&&(c="请选择审批人",f.tips({content:c,time:1500})),c&&c.length>0?!1:!0}function d(a){switch(a.type){case"date":return"请选择"+a.title;case"image":return"请上传"+a.title;case"number":return a.title+"不能为空且必须为数字";case"radio":return"请选择"+a.title;default:return a.title+"内容不能为空"}}var e=a("../model/data"),f=a("../view/dialog"),g=a("../tools/method"),h=a("../model/approver").approver,i={text:20,textarea:400,number:20},j={text:function(a,b){var c=a.querySelector("[data-native]"),e=c.value,f=i[b.type];return b.require&&e.length<1?d(b):g.strlen(e)>f[b.type]?b.title+"最多输入"+f+"个字":void 0},textarea:function(a,b){return this.text(a,b)},number:function(a,b){var c=a.querySelector("[data-native]"),e=c.value,f=i[b.type];return b.require&&e.length<1?d(b):e.length>f?b.title+"最多输入"+f+"个数字":void 0},radio:function(a,b){var c=a.querySelector("[data-native]");return b.require&&!c.dataset.enabled?d(b):void 0},date:function(a,b){var c=a.querySelector("[data-native]");return b.require&&c.value.length<1?d(b):void 0},dateRange:function(a,b){var c=a.querySelectorAll("[data-native]"),d=c[0].value,e=c[1].value;if(b.require){if(d.length<1)return"请选择"+b.title;if(e.length<1)return"请选择"+b.title2}if(d.length>0&&e.length>0){var f=new Date(d).getTime(),g=new Date(e).getTime();if(f>g)return b.title+"不能大于"+b.title2}},image:function(a,b){var c=a.querySelectorAll("img");return b.require&&c.length<1?d(b):void 0}};b.check=c}),define("mobile/js/controller/watch",["./file-handler","../view/dialog","../../../config/config","../model/search","../tools/method","../tools/slide","../tools/base64","./detail-handler","../view/templates","../model/data","./submit","./validation","../model/approver","./approver-handler","../tools/escape"],function(a,b){function c(){document.addEventListener("input",e,!1),document.addEventListener("change",e,!1),document.on("tap",d)}function d(b){var c=b.target;switch(c.dataset.action){case"delete-image":a("./file-handler").del.hanlder(c);break;case"delete-detail":a("./detail-handler").del.handler(c);break;case"add-detail":a("./detail-handler").add.hanlder(c);break;case"submit":a("./submit").submit();break;case"add-approver":setTimeout(function(){a("./approver-handler").approver.addHanlder()},350);break;case"del-approver":a("./approver-handler").approver.delHanlder(c)}}function e(b){var c=b.target,d=c.value;if(c.classList.contains("item-native"))if("file"===c.getAttribute("type"))a("./file-handler").upload.hanlder(c);else if("请选择"!==d&&"请选择（必填）"!==d){var e=c.previousElementSibling;e.classList.remove("item-prompt"),c.dataset.enabled=!0,"datetime"===c.getAttribute("type")?e.innerHTML=f(d):e.innerHTML=a("../tools/escape").escape(d)}}function f(a){var b=new Date(a),c=b.getFullYear()+"-"+g(b.getMonth()+1)+"-"+g(b.getDate()),d=" "+g(b.getHours())+":"+g(b.getMinutes());return c+d}function g(a){return a>9?a:"0"+a}b.init=c}),define("mobile/js/model/approver",[],function(a,b,c){var d={torealname:[],toid:[],add:function(a,b){this.torealname.push(a),this.toid.push(b)},exists:function(a){return-1===this.toid.indexOf(a)?!1:!0},del:function(a){var b=this.toid.indexOf(a);console.log(b),b>-1&&(this.torealname.splice(b,1),this.toid.splice(b,1))},get:function(){return"&toid="+this.toid.join(",")+"&torealname="+this.torealname.join(",")}};window.abc=d,b.approver=d}),define("mobile/js/model/data",[],function(a,b,c){function d(a){var b=e(a);i[-1]=b.splice(0,1);var c=f(b,0);c=g(c),i[0]=c;for(var d=0;d<c.length;d++){var a=c[d];if("detail"==a.type){var h=f(b,a.id);h=g(h),i[a.id]=h}}}function e(a){var b=[],c=/},{/g,d=a.replace(c,"},?&${");d=d.split(",?&$");for(var e=0;e<d.length;e++)b.push(JSON.parse(d[e]));return b}function f(a,b){for(var c=[],d=0;d<a.length;d++)a[d].parentId==b&&(c=c.concat(a.splice(d--,1)));return c}function g(a){if(a.length<=1)return a;for(var b=Math.floor(a.length/2),c=a.splice(b,1),d=c[0].order,e=[],f=[],h=0;h<a.length;h++)a[h].order<d?e.push(a[h]):f.push(a[h]);return g(e).concat(c,g(f))}function h(a){for(key in i)for(var b=i[key],c=0;c<b.length;c++)if(b[c].id==a)return b[c];return null}var i={};window.temp=i,c.exports={DATA:i,format:d,getData:h}}),define("mobile/js/model/search",["../tools/method","../../../config/config"],function(a,b){function c(){var a=decodeURI(window.location.search);if(-1!=a.indexOf("?")){var b=a.substr(1);return b}return null}function d(a){for(var b={},c=a.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");b[e[0]]=e[1]}return b}function e(){var a=window.location.origin+window.location.pathname;return a.substring(0,a.lastIndexOf("/")+1)}var f,g,h=(a("../tools/method"),c());null!==h&&(f=d(h)),f&&f.torealname&&(g=f.torealname.split(",")),b.sSearch=h,b.oSearch=f,b.getUrlPrefix=e,b.aApproverList=g}),define("mobile/js/tools/base64",[],function(a,b,c){function d(a,b){var c=new FileReader;c.readAsDataURL(a),c.onload=function(){e(this.result,a.type,b)}}function e(a,b,c){var d=document.createElement("canvas"),e=d.getContext("2d"),g=new Image;d.width=120,d.height=120,g.onload=function(){var h=this.width,i=this.height,j=a;i>h?e.drawImage(this,0,(i-h)/2,h,h,0,0,120,120):e.drawImage(this,(h-i)/2,0,i,i,0,0,120,120);var k=d.toDataURL(b);h>480&&(j=f(d,e,b,g)),c(k,j)},g.src=a}function f(a,b,c,d){var e=d.height/d.width;return a.width=480,a.height=480*e,b.drawImage(d,0,0,a.width,a.height),a.toDataURL(c)}b.handler=d}),define("mobile/js/tools/escape",[],function(a,b,c){function d(a){return"string"!=typeof a?"":a.replace(i.escape,function(a){return h.escape[a]})}function e(a){return"string"!=typeof a?"":a.replace(i.unescape,function(a){return h.unescape[a]})}var f=Object.keys||function(a){a=Object(a);var b=[];for(var c in a)b.push(c);return b},g=function(a){a=Object(a);var b={};for(var c in a)b[a[c]]=c;return b},h={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"}};h.unescape=g(h.escape);var i={escape:RegExp("["+f(h.escape).join("")+"]","g"),unescape:RegExp("("+f(h.unescape).join("|")+")","g")};c.exports={escape:d,unescape:e}}),define("mobile/js/tools/method",[],function(a,b,c){function d(a){var b=a.offsetTop;return null!=a.offsetParent&&(b+=d(a.offsetParent)),b}function e(a){var b=a.offsetLeft;return null!=a.offsetParent&&(b+=e(a.offsetParent)),b}function f(a){return document.createElement(a)}function g(a,b,c,d){var e=a;if(e==d)return e;for(;e.getAttribute(b)!=c&&e.parentNode!=d;)e=e.parentNode;return e}function h(a){var b=document.createElement("div");return b.innerHTML=a,b.childNodes}function i(a,b){var c=b.parentNode;b==c.lastChild?c.insertBefore(a,null):c.insertBefore(a,b.nextSibling)}function j(a,b){return"function"==typeof a.contains?a.contains(b):"function"==typeof a.compareDocumentPosition?!!(16&a.compareDocumentPosition(b)):void 0}function k(a,b){for(var c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);if(c+=e>=1&&126>=e||e>=65376&&65439>=e?.5:1,c>=b){var f=c==b?d+1:d;return a.substr(0,f)}}return a}function l(a){for(var b=0,c=0;c<a.length;c++){var d=a.charCodeAt(c);d>=1&&126>=d||d>=65376&&65439>=d?b++:b+=2}return Math.ceil(b/2)}function m(a){var b=f("script");b.src=a,document.body.appendChild(b)}function n(a){var b,c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c)b={};else{if("Array"!==c)return a;b=[]}for(var d in a)b[d]=n(a[d]);return b}function o(a){a.beforeSend&&a.beforeSend(),xhr=new XMLHttpRequest,"post"!=a.type&&(a.type="get",a.data&&(a.url+="?"+a.data)),xhr.open(a.type,a.url,!0),"get"==a.type?xhr.send():(xhr.setRequestHeader("content-type","application/x-www-form-urlencoded"),xhr.send(a.data)),xhr.onreadystatechange=function(){4==xhr.readyState&&(200==xhr.status?a.success&&a.success(xhr.responseText):a.error&&a.error(xhr.status))}}Node.prototype.on=function(a,b){this.listeners=this.listeners||{},this.listeners[a]=this.listeners[a]||[],this.listeners[a].push(b);for(key in p)p.hasOwnProperty(key)&&key===a&&p.builder.call(this,a)},Node.prototype.trigger=function(a,b){if(this.listeners&&this.listeners[a])for(var c=0;c<this.listeners[a].length;c++)this.listeners[a][c].call(this,b)};var p={builder:function(a){this.CustomEvent||(this.CustomEvent={}),this.CustomEvent[a]||(this.CustomEvent[a]=!0,p[a].call(this,a))},tap:function(a){var b,c;this.addEventListener("touchstart",function(a){var d=a.touches[0];b=d.clientX,c=d.clientY},!1),this.addEventListener("touchend",function(d){var e=d.changedTouches[0],f=e.clientX,g=e.clientY;Math.abs(b-f)<6&&Math.abs(c-g)<6&&setTimeout(function(b){b.trigger(a,d)},10,this)},!1)},longTap:function(a){var b,c,d;this.addEventListener("touchstart",function(e){d&&(clearTimeout(d),d=null);var f=e.touches[0];b=f.clientX,c=f.clientY,d=setTimeout(function(b){b.trigger(a,e)},1e3,this),e.preventDefault()},!1),this.addEventListener("touchmove",function(a){var e=a.touches[0],f=e.clientX,g=e.clientY;d&&(Math.abs(f-b)>5||Math.abs(g-c)>5)&&(clearTimeout(d),d=null)},!1),this.addEventListener("touchend",function(a){d&&(clearTimeout(d),d=null)},!1)}};c.exports={getTop:d,getLeft:e,create:f,getTarget:g,parseDOM:h,insertAfter:i,DomContains:j,substr:k,strlen:l,loadHtml:m,deepCopy:n,ajax:o}}),function(a,b){a("mobile/js/tools/slide",[],function(){"use strict";function c(a,b){for(var c in b)a[c]=b[c]}function d(a,b){this.listeners=this.listeners||{},this.listeners[a]=this.listeners[a]||[],this.listeners[a].push(b)}function e(a,b){if(this.listeners&&this.listeners[a])for(var c=0;c<this.listeners[a].length;c++)this.listeners[a][c].apply(this,b)}function f(a,b,c){var d=a;if(d==g)return d;for(;d.dataset[b]!=c&&d.parentNode&&d.parentNode!=g;)d=d.parentNode;return d}var g=b.document,h=function(a){this.setting={listSelector:"li",autoPlay:!1,time:5e3},c(this.setting,a),this.cont=this.setting.cont,this.aItem=this.cont.querySelectorAll(this.setting.listSelector),this.iNum=0,this.init()};h.prototype={constructor:h,init:function(){for(var a=0;a<this.aItem.length;a++)this.aItem[a].style.webkitTransform="translate("+a*b.innerWidth+"px, 0)";g.querySelector("html").style.overflowX="hidden",this.bindEvent(),this.setting.autoPlay&&this.autoPlay(),setTimeout(function(a){a.cont.classList.add("translate")},0,this)},bindEvent:function(){this.cont.addEventListener("touchstart",this.touchStartHandler.bind(this),!1),this.cont.addEventListener("touchmove",this.touchMoveHandler.bind(this),!1),this.cont.addEventListener("touchend",this.touchEndHandler.bind(this),!1)},touchStartHandler:function(a){this.disX=a.touches[0].pageX,this.disY=a.touches[0].pageY,this.offsetX=0,this.interval=new Date,this.cont.classList.remove("translate");var b=navigator.control||{};b.gesture&&b.gesture(!1),this.trigger("touchstart")},touchMoveHandler:function(a){this.offsetX=a.touches[0].pageX-this.disX,this.offsetY=a.touches[0].pageY-this.disY;var c=Math.abs(this.offsetX)>Math.abs(this.offsetY);c&&((0===this.iNum&&this.offsetX>0||this.iNum===this.aItem.length-1&&this.offsetX<0)&&(this.offsetX*=.2),this.aItem[this.iNum-1]&&(this.aItem[this.iNum-1].style.webkitTransform="translate3d("+(-b.innerWidth+this.offsetX)+"px, 0, 0)"),this.aItem[this.iNum].style.webkitTransform="translate3d("+this.offsetX+"px, 0, 0)",this.aItem[this.iNum+1]&&(this.aItem[this.iNum+1].style.webkitTransform="translate3d("+(b.innerWidth+this.offsetX)+"px, 0, 0)"),a.preventDefault(),this.trigger("touchmove"))},touchEndHandler:function(a){var c=b.innerWidth/2,d=b.innerWidth/10;this.cont.classList.add("translate"),new Date-this.interval>300?this.offsetX>c?this.touchEndMove(-1):this.offsetX<-c?this.touchEndMove(1):this.touchEndMove(0):this.offsetX>d?this.touchEndMove(-1):this.offsetX<-d?this.touchEndMove(1):this.touchEndMove(0),this.trigger("touchend");var e=navigator.control||{};e.gesture&&e.gesture(!0)},touchEndMove:function(a){this.iNum+=a,this.iNum>=this.aItem.length?this.iNum=this.aItem.length-1:this.iNum<0&&(this.iNum=0),this.aItem[this.iNum-1]&&(this.aItem[this.iNum-1].style.webkitTransform="translate3d("+-b.innerWidth+"px, 0, 0)"),this.aItem[this.iNum].style.webkitTransform="translate3d(0, 0 ,0)",this.aItem[this.iNum+1]&&(this.aItem[this.iNum+1].style.webkitTransform="translate3d("+b.innerWidth+"px, 0, 0)"),this.trigger("slidend")},recursion:function(){function a(c,d){this.aItem[c+d]&&(this.aItem[c+d].style.webkitTransform="translate3d("+d*b.innerWidth+"px, 0, 0)",a.call(this,c+d,d))}a.call(this,this.iNum,-1),a.call(this,this.iNum,1)},toMoveIndex:function(a){this.iNum=a,this.touchEndMove(0),this.recursion()},autoPlay:function(){function a(){this.iNum++,this.iNum>=this.aItem.length&&(this.iNum=0),this.touchEndMove(0),0===this.iNum&&this.recursion()}var b=this;this.timer=setInterval(a.bind(this),this.setting.time),this.on("touchstart",function(){clearInterval(b.timer)}),this.on("touchend",function(){b.timer=setInterval(a.bind(b),b.setting.time)})},on:d,trigger:e};var i=function(a){h.call(this,a),this.pageTag=this.setting.pageTag,this.aImg=this.cont.getElementsByTagName("img"),this.bindCustomEvent()};c(i.prototype,h.prototype);var j={constructor:i,bindCustomEvent:function(){this.on("slidend",this.pageCount),this.on("slidend",this.loadImg)},pageCount:function(){this.iAllPage=this.aItem.length,this.pageTag.innerHTML=this.iNum+1+"/"+this.iAllPage},loadImg:function(){function a(a){a&&!a.src&&(a.onload=function(){a.classList.add("show"),a.parentNode.classList.add("loaded")},a.src=a.dataset.src,a.dataset.src="")}a(this.aImg[this.iNum-1]),a(this.aImg[this.iNum]),a(this.aImg[this.iNum+1])}};c(i.prototype,j);var k={iNum:0,init:function(){var a=this;g.addEventListener("click",function(b){var c=f(b.target,"role","photo");"photo"==c.dataset.role&&(a.parent=c,a.openPhoto(b))},!1)},openPhoto:function(a){var b=a.target;this.aImg=this.parent.querySelectorAll("img[data-src]");for(var c=0;c<this.aImg.length;c++)this.aImg[c].index=c;"img"==b.nodeName.toLowerCase()&&""!==b.dataset.src&&(this.iNum=a.target.index,this.createDOM(),this.initPhoto(),this.closePhoto())},initPhoto:function(){var a=new i({cont:this.oWrapper,listSelector:"div.item",pageTag:this.pageCount});a.toMoveIndex(this.iNum),this.scrollTop=g.body.scrollTop,g.body.style.height=0},closePhoto:function(){var a=this;this.oWrapper.addEventListener("click",function(){g.body.removeChild(this),g.body.style.height="auto",g.body.scrollTop=a.scrollTop},!1)},createDOM:function(){this.oWrapper=g.createElement("div"),this.oWrapper.classList.add("dialog-photo"),this.oWrapper.classList.add("show");for(var a=0;a<this.aImg.length;a++)this.oWrapper.innerHTML+='<div class="item"><img data-src="'+this.aImg[a].dataset.src+'"></div>';this.pageCount=g.createElement("span"),this.pageCount.classList.add("photo-page"),this.oWrapper.appendChild(this.pageCount),g.body.appendChild(this.oWrapper)}};k.init();var l={init:function(){this.aFcous=document.querySelectorAll("[data-role=focus]");for(var a=0;a<this.aFcous.length;a++)this.factory(this.aFcous[a])},factory:function(a){var b=a.dataset,c=new h({cont:a,listSelector:"[role=item]",autoPlay:"false"===b.autoPlay?!1:!0,time:"undefined"==typeof b.time?5e3:b.time}),d=this.appendDot(a,c);a.style.height=b.height,c.on("slidend",function(){for(var a=0;a<d.length;a++)d[a].classList.remove("active");d[c.iNum].classList.add("active")})},appendDot:function(a,b){for(var c,d=a.querySelector("[role=dot]"),e=b.aItem.length,f=0;e>f;f++)d.innerHTML+="<span></span>";return c=d.getElementsByTagName("span"),c[0].classList.add("active"),c}};l.init();var m={Slide:h,Photo:i};return a.amd||a.cmd||(b.Slider=m),m})}("function"==typeof define&&(define.amd||define.cmd)?define:function(a,b,c){"function"==typeof a&&(c=a),"function"==typeof b&&(c=b),c&&c()},window),define("mobile/js/view/dialog",[],function(a,b,c){function d(){l=arguments[0],h();var a=f(!0);return a}function e(){l=arguments[0],h();var a=f(!1);return"loading"!==l.type&&setTimeout(function(){a.close(),l.onTimeEnd&&l.onTimeEnd()},l.time?l.time:2e3),a}function f(a){var b=document.createElement("div");return b.classList.add("mask"),b.style.height=document.body.scrollHeight+"px",b.innerHTML=j(a),document.body.appendChild(b),btnTrue=b.querySelector("input[data-type=yes]"),btnFalse=b.querySelector("input[data-type=no]"),main=b.querySelector(".dialog-main"),btnTrue&&i(btnTrue,b),btnFalse&&i(btnFalse,b),{mask:b,main:main,btnTrue:btnTrue,btnFalse:btnFalse,close:g.bind(b)}}function g(){this&&this.parentNode&&this.parentNode.removeChild(this),document.body.style.pointerEvents="none",setTimeout(function(){document.body.style.pointerEvents="auto"},320)}function h(){for(var a=document.querySelectorAll(".mask"),b=0;b<a.length;b++)a[b].parentNode.removeChild(a[b])}function i(a,b){a.addEventListener("touchend",g.bind(b),!1)}function j(a){var b,c=l.padding?'style="padding:'+l.padding+'"':"";return b="loading"===l.type?'<i class="tips-loading"></i>'+l.content:l.content,['<div class="dialog">','<div class="dialog-main" '+c+">"+b+"</div>",a?k():"","</div>"].join("")}function k(){return['<div class="dialog-btns">','<input type="button" data-type="no" value="取消" />','<input type="button" data-type="yes" value="确定" />',"</div>"].join("")}var l;b.dialog=d,b.tips=e}),define("mobile/js/view/templates",["../tools/method"],function(a,b){function c(){var a=u.create("section");return a.classList.add("main"),a.id="main",a}function d(a){switch(r=a,dataId="data-native=true",s=r.require,t="data-parentId="+r.parentId+" data-order="+r.order,r.type){case"radio":return f();case"date":return g();case"dateRange":return h();case"image":return j();case"detail":return k();case"submit":return m();case"approver":return n();case"approverList":return o();default:return e()}}function e(){var a="",b="number"==r.type?"number":"text";return a="textarea"==r.type?'<textarea type="text" class="item-text" '+dataId+' placeholder="'+r.prompt+s+'"></textarea>':'<input type="'+b+'" class="item-text" '+dataId+' placeholder="'+r.prompt+s+'" />',['<div class="form-item-'+r.type+'" '+t+">",'<div class="item-border">','<label for="" class="item-title">',r.title,"</label>",'<span class="item-text-wrap">',a,"</span>","</div>","</div>"].join("")}function f(){for(var a='<option value="请选择'+s+'">请选择'+s+"</option>",b=0;b<r.options.length;b++)a+='<option value="'+r.options[b]+'">'+r.options[b]+"</option>";return['<div class="form-item-radio" '+t+">",'<div class="item-border">','<label for="" class="item-title">',r.title,"</label>",'<span class="item-native-text item-prompt">请选择'+s+"</span>",'<select class="item-native" '+dataId+">",a,"</select>","</div>","</div>"].join("")}function g(){return['<div class="form-item-date"  '+t+">",i(r.title),"</div>"].join("")}function h(){return['<div class="form-item-dateRange"  '+t+">",i(r.title),i(r.title2),"</div>"].join("")}function i(a){return['<div class="item-border">','<label for="" class="item-title">',a,"</label>",'<span class="item-native-text  item-prompt">请选择'+s+"</span>",'<input type="'+r.datetype+'" class="item-native" '+dataId+" />","</div>"].join("")}function j(){var a=r.require?'<span class="item-prompt">（必填）</span>':"";return['<div class="form-item-image"  '+t+">",'<div class="item-border">','<label for="" class="item-title">',r.title,a,'<input type="file" accept="image/*" class="item-native" />',"</label>",'<div class="image-list" '+dataId+' data-role="photo">',"</div>","</div>","</div>"].join("")}function k(){return['<div class="form-item-detail"  '+t+">",l(r.title,1),'<div class="detail-add" data-action="add-detail" data-id='+r.id+">"+r.addDetail+"</div>","</div>"].join("")}function l(a,b,c){return['<div class="detail-title-wrap">','<label for="" class="detail-title">'+a+'(<em class="detail-num">'+b+"</em>)</label>",c?'<a class="detail-delete" data-action="delete-detail">删除</a>':"","</div>",'<div class="detail-area"  '+dataId+">","</div>"].join("")}function m(){return['<div class="submit-btn-wrap">','<input type="button" value="提交" class="submit-btn" data-action="submit" />',"</div>	"].join("")}function n(){return['<div class="form-item-approver">','<div class="item-border">','<label class="approver-title">审批人<em>(点击头像可删除)</em></label>','<ul class="approver-list">',"<li>",'<a class="add-approver" data-action="add-approver"></a>',"</li>","</ul>","</div>","</div>"].join("")}function o(){return['<section class="select-approver">','<div class="approver-header">','<a class="approver-getback"></a>',"添加审批人","</div>",'<div class="approver-search">','<input type="text" class="approver-search-input" placeholder="搜索姓名">',"</div>",'<div class="select-approver-list">',"</div>",'<div class="no-approver"></div>',"</section>	"].join("")}function p(a,b){return'<a data-personid="'+b+'" data-name="'+a+'"><em>'+a+"</em>"+a+"</a>"}function q(a,b){return'<li><span  data-name="'+a+'" data-personid="'+b+'" data-action="del-approver">'+a+"</span><em>"+a+"</em></li>"}var r,a,s,t,u=a("../tools/method");b.getMain=c,b.getWidget=d,b.tDetailInner=l,b.tApproverItem=p,b.tSelectedApprover=q}),define("config/config",[],function(a,b,c){var d="http://";d+=-1!==window.location.host.indexOf("css.tianyuyun.cn")?"116.211.105.45:20013":"10.8.10.55:8080";var e={preview:"php/preview.php",template:"php/template.php",save:"server/save.php",file:"../server/file.php",submit:"../server/submit.php",getApprover:d+"/friendcircle/audit/qteacher",designDataPath:"php/data/",mobileDataPath:"http://appdesign-design.stor.sinaapp.com/data/"};c.exports={Path:e}});