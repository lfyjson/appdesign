define("design/js/main",["./controller/drag","./view/phone","./tools/method","./model/data","./model/search","./controller/setting","./view/setting","./model/insert","./controller/databind","./tools/escape","./controller/validation","./controller/handlers","./controller/prompt","./view/dialog","./model/delete","./view/load-body","./controller/load-template","../../config/config","./model/format","./controller/preview","./tools/qrcode","./controller/save","./controller/modify-template","./tools/observer"],function(a,b,c){function d(){a("./controller/drag").init(),a("./controller/load-template").loadScript(),a("./controller/databind"),a("./controller/prompt").detection(),a("./controller/preview").init(),a("./controller/save"),a("./controller/modify-template").init()}function e(b){document.body.dataset.id,a("./view/load-body"),b()}e(d)}),define("design/js/controller/databind",["../tools/escape","../controller/validation","../model/data","../model/search","../tools/method","./handlers","../view/setting","./validation"],function(a,b,c){"use strict";function d(b,c){function d(){for(var a in k)g(a,k[a],m,l);Object.defineProperties(k,h(l))}function g(a,c,d,e){d[a]=c;var g=function(c){var e=d[a];return arguments.length?void(e!==c&&(d[a]=f.escape(c),j.trigger(b+":change",a,c,this))):e};e[a]=g}function h(a){var b={};for(var c in a)b[c]={set:a[c],get:a[c],enumerable:!0,configurable:!0};return b}var i=a("../controller/validation"),j=(a("../model/data"),new e(b)),k={},l={},m={},n=c(k);return n&&(k=JSON.parse(JSON.stringify(n)),m=n),d(),j.on(b+":change",function(a,c,d,e){e!==k&&(d=i.DBModelVerify(c,d,e,b,k),k[c]=d)}),k}function e(b){var c={callbacks:{},on:function(a,b){this.callbacks[a]=this.callbacks[a]||[],this.callbacks[a].push(b)},trigger:function(a){this.callbacks[a]=this.callbacks[a]||[];for(var b=0,c=this.callbacks[a].length;c>b;b++)this.callbacks[a][b].apply(this,arguments)}},d="data-bind-"+b,e=b+":change",g=function(a){var b=a.target,f=b.getAttribute(d);f&&""!==f&&c.trigger(e,f,b.value,b)};return document.addEventListener("input",g,!1),document.addEventListener("change",g,!1),document.addEventListener("click",g,!1),c.on(e,function(c,e,g,h){if(!(1===h.nodeType&&window.Node&&h instanceof Node)){if("curIcon"===e)return void a("./handlers").iconHanlder(b,g);for(var i,j=document.querySelectorAll("["+d+"="+e+"]"),k=0,l=j.length;l>k;k++)i=j[k].tagName.toLowerCase(),"radio"!==j[k].getAttribute("type")&&("input"===i||"textarea"===i||"select"===i?(g=f.unescape(g),j[k].value!==g&&(j[k].value=g)):(g=f.escape(g),j[k].innerHTML!==g&&(j[k].innerHTML=g)))}}),c}var f=a("../tools/escape");c.exports={DataBinder:e,DBModel:d}}),define("design/js/controller/drag",["../view/phone","../tools/method","../model/data","../model/search","./setting","../view/setting","../model/insert","./databind","../tools/escape","./validation","./handlers","./prompt","../view/dialog","../model/delete","../view/load-body"],function(require,exports,module){function init(){var a=document.getElementById("controls"),b=document.getElementById("phone-body");new Drag({parent:a,objName:"control"}),new Drag({parent:b,objName:"phone-item"})}var Phone=require("../view/phone"),Model=require("../model/data"),Setting=require("./setting").setting,InsertData=require("../model/insert"),Prompt=require("./prompt"),m=require("../tools/method"),Drag=function(a){this.parent=a.parent,this.objName=a.objName,this.phoneInner=document.getElementById("phone-inner"),this.phoneBody=document.getElementById("phone-body"),this.aControl=document.querySelectorAll("#controls .control-item"),this.init()};Drag.prototype={constructor:Drag,createShadow:function(){for(var i=0;i<this.aControl.length;i++)this.aControl[i].dataset.type==this.type&&(this.shadow=this.aControl[i].cloneNode(!0));with(this.shadow.style)backgroundColor="rgba(0, 0, 0, .5)",position="absolute",left=0,top=0,transition="none",zIndex=9},createPlaceholder:function(){this.placeholder=document.createElement("div"),this.placeholder.className="placeholder"},init:function(){var a=this;this.parent.onmousedown=function(b){if(a.obj=m.getTarget(b.target,"name",a.objName,this),a.obj.getAttribute("name")==a.objName){var c=0,d=!1;return document.onmousemove=function(b){if(10>c)return void c++;d||(d=!0,a.mouseDownInit()),b.clientY+50>a.innerBottom?a.phoneInner.scrollTop+=15:a.innerTop+50>b.clientY&&(a.phoneInner.scrollTop-=15);var e="translate3d("+b.clientX+"px, "+b.clientY+"px, 0)";if(a.shadow.style.webkitTransform=e,a.shadow.style.mozTransform=e,a.shadow.style.msTransform=e,a.shadow.style.transform=e,a.isInPhoneInner(b,a.phoneInnerLeft,a.phoneInnerTop,a.phoneInner)){if(a.interval){a.interval=!1;var f=a.findNearest(a.shadow,a.phoneItems,b);"detail"==a.type&&f.parentNode.classList.contains("phone-area")||f.parentNode.insertBefore(a.placeholder,f),setTimeout(function(){a.interval=!0},100)}}else a.placeholder.parentNode&&a.placeholder.parentNode.removeChild(a.placeholder)},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,c=0,d&&(document.body.classList.remove("drag-move"),document.body.removeChild(a.shadow),a.obj.classList.remove("filter"),"control"==a.objName?a.placeholder.parentNode&&a.insertNewItem():a.setItem(a.placeholder.parentNode,a.obj),Prompt.detection(),a.itemOrder())},!1}}},itemOrder:function(){for(var a=this.phoneInner.querySelectorAll(".phone-body > .phone-item"),b=this.phoneBody.querySelectorAll(".phone-area"),c=0;c<a.length;c++)Model.updateData(a[c].dataset.id,"order",c+1),Model.updateData(a[c].dataset.id,"parentId",0);for(var c=0;c<b.length;c++)for(var a=b[c].querySelectorAll(".phone-item"),d=0;d<a.length;d++)Model.updateData(a[d].dataset.id,"order",d+1),Model.updateData(a[d].dataset.id,"parentId",parseInt(b[c].parentNode.parentNode.dataset.id))},mouseDownInit:function(){this.type=this.obj.dataset.type,this.createShadow(),this.createPlaceholder(),this.interval=!0,this.innerTop=m.getTop(this.phoneInner),this.innerBottom=this.innerTop+this.phoneInner.offsetHeight,this.phoneInnerLeft=m.getLeft(this.phoneInner),this.phoneInnerTop=m.getTop(this.phoneInner),this.getPhoneItems(),document.body.appendChild(this.shadow),document.body.classList.add("drag-move"),this.obj.classList.add("filter")},insertNewItem:function(){var a=InsertData.insertNewItem(this.obj),b=Model.getData(a),c=Phone.createWidget(b);Model.updateData(b.id,"obj",c),this.setItem(this.placeholder.parentNode,c)},setItem:function(a,b){a&&a.insertBefore(b,this.placeholder),a&&a.removeChild(this.placeholder),Setting.toActive(b)},getPhoneItems:function(){this.phoneItems=this.phoneBody.querySelectorAll('div[name="phone-item"]')},findNearest:function(a,b,c){for(var d=1e10,e=-1,f=0;f<b.length;f++)if(a!=b[f]){var g=this.getDis(a,b[f],c);d>g&&(d=g,e=f)}return-1==e?null:b[e]},getDis:function(a,b,c){var d=c.clientX-m.getLeft(b),e=c.clientY-m.getTop(b)+this.phoneInner.scrollTop;return Math.sqrt(d*d+e*e)},isInPhoneInner:function(a,b,c,d){var e=b+d.offsetWidth,f=c+d.offsetHeight;return a.clientX<b||a.clientX>e||a.clientY<d.offsetTop||a.clientY>f?!1:!0}},exports.init=init,exports.Drag=Drag}),define("design/js/controller/handlers",["../model/data","../model/search","../tools/method","../view/setting","./validation","../tools/escape"],function(a,b,c){function d(){function a(a){switch(a.dataset.model){case"option-add":return"option-add";case"option-delete":return"option-delete";default:return!1}}p.addEventListener("click",function(b){var c=b.target,d=a(c);if(d){var g=i(c),h=k.getData(g);switch(d){case"option-add":e(c,h);break;case"option-delete":f(c,h)}}},!1),p.addEventListener("input",function(a){var b,c=a.target;"options"===c.dataset.model&&(b=i(c),h(b,c))},!1)}function e(a,b){var c=a.parentNode,d=c.parentNode,e=new l(b),f=n.parseDOM(e.tOption("选项"+ ++b.optionsIndex))[0];n.insertAfter(f,c),k.updateOptions(b.id,c.dataset.index,"add"),g(d),d.classList.remove("limit-delete"),b.options.length>=200&&d.classList.add("limit-add")}function f(a,b){var c=a.parentNode,d=c.parentNode;c.parentNode.removeChild(c),k.updateOptions(b.id,c.dataset.index,"delete"),g(d),d.classList.remove("limit-add"),b.options.length<=1&&d.classList.add("limit-delete")}function g(a){for(var b=a.querySelectorAll(".setting-option"),c=0;c<b.length;c++)b[c].dataset.index=c}function h(a,b){var c,d=b.parentNode;c=m.optionVerify(b),"undefined"!=typeof c&&(b.value=c),k.updateOptions(a,d.dataset.index,"update",o.escape(b.value))}function i(a){for(var b=a.parentNode;"html"!=b.nodeName.toLowerCase()&&void 0==b.dataset.id;)b=b.parentNode;return b.dataset.id}function j(a,b){for(var c=document.querySelectorAll("[data-role=curIconWrap]"),d=0;d<c.length;d++)for(var e=c[d].getElementsByTagName("img"),f=0;f<e.length;f++)e[f].dataset.value===b?e[f].parentNode.classList.add("active"):e[f].parentNode.classList.remove("active")}var k=a("../model/data"),l=a("../view/setting").Templates,m=a("./validation"),n=a("../tools/method"),o=a("../tools/escape"),p=document.getElementById("setting-wrap");d(),b.iconHanlder=j}),define("design/js/controller/load-template",["../model/search","../tools/method","../../../config/config","../model/format","../model/data","../view/phone","./prompt","../view/dialog","../view/setting","../view/load-body","./setting","../model/insert","./databind","../tools/escape","./validation","./handlers","../model/delete","../controller/databind"],function(a,b,c){function d(){var a=m.getTplPath();if(""===a)window.location.hash="#.tpl/empty";else if("default"===a){var b=window.sessionStorage.getItem("default");b?e(b):window.location.hash="#.tpl/empty"}else""!==a&&(p.CACHE[a]?e(p.CACHE[a]):(l=document.createElement("script"),l.src=n.designDataPath+a+".js",document.body.appendChild(l)));g()}function e(a,b){f();for(var c=o.format(a),d=c[0],e=0;e<d.length;e++){var g=q.createWidget(d[e]);if(x.insertBefore(g,k),"detail"==d[e].type)for(var i=g.querySelector(".phone-area"),j=g.querySelector("div[data-role=area]"),l=c[d[e].id],m=0;m<l.length;m++){var n=q.createWidget(l[m]);p.updateData(l[m].id,"obj",n),i.insertBefore(n,j)}}t.id=0,t.showSetting(0,!0),r.detection(),h();for(var s in p.DATA)w.DBModel(p.DATA[s].id,function(a){return p.DATA[s]})}function f(){x.innerHTML="",x.innerHTML+=s.tPlaceholder(),k=x.querySelector("div[data-role=placeholder]")}function g(){var a=y.length-1;setTimeout(function(){y[a]&&(window.sessionStorage.getItem("default")&&j("message",{status:0,text:"模板切换失败"}),i())},3e3)}function h(){var a=m.getTplPath();a&&y[y.length-1]&&(window.sessionStorage.getItem("default")&&j("message",{status:1,text:"成功切换到"+v.getTplName(a)+"模板"}),y[y.length-1]=!1),i(),window.sessionStorage.getItem("default")||window.sessionStorage.setItem("default",p.getFormatData(p.CACHE["default"]))}function i(){l&&l.parentNode&&l.parentNode.removeChild(l)}function j(a,b){window.sessionStorage.getItem("default")&&u[a](b)}var k,l,m=a("../model/search"),n=a("../../../config/config").Path,o=a("../model/format"),p=a("../model/data"),q=a("../view/phone"),r=a("./prompt"),s=a("../view/load-body"),t=a("./setting").setting,u=a("../view/dialog"),v=a("../view/load-body"),w=(a("../tools/method"),a("../controller/databind")),x=document.getElementById("phone-body"),y=[];window.addEventListener("hashchange",function(){j("dialog",{type:"loading",content:"正在切换模板"});for(var a=0;a<y.length;a++)y[a]=!1;y.push(!0),d()},!1),window.loadWidget=e,b.loadScript=d}),define("design/js/controller/modify-template",["../tools/method","../tools/observer"],function(require,exports,module){function init(){new Drag({wrap:document.querySelector(".main"),phoneInner:document.getElementById("phone-inner")})}function Drag(a){this.wrap=a.wrap,this.phoneInner=a.phoneInner,this.init()}var m=require("../tools/method"),Observer=require("../tools/observer");Drag.prototype={constructor:Drag,init:function(){var a=this;this.inOutPhoneHandler(),this.wrap.onmousedown=function(b){if(a.obj=b.target,"tpl"===a.obj.dataset.name){var c=!1,d=!1,e=0;return document.onmousemove=function(b){if(5>e)return void e++;c||(a.mouseDownInit(),c=!0);var f="translate3d("+b.clientX+"px, "+b.clientY+"px, 0)";a.shadow.style.webkitTransform=f,a.shadow.style.mozTransform=f,a.shadow.style.msTransform=f,a.shadow.style.transform=f,a.isInPhoneInner(b,a.phoneInnerLeft,a.phoneInnerTop,a.phoneInner)?(d||a.pub("inPhone"),d=!0):(d&&a.pub("outPhone"),d=!1)},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,a.shadow&&(document.body.removeChild(a.shadow),a.shadow=null),d&&(window.location.hash=a.getHash(),a.pub("changeSuccess")),document.body.classList.remove("drag-move")},!1}}},getHash:function(){return this.obj.href.substring(this.obj.href.indexOf("#"))},inOutPhoneHandler:function(){this.tplPrompt=document.querySelector(".phone-tpl-prompt"),this.tplPromptSpan=this.tplPrompt.querySelector("span"),this.phoneBody=document.getElementById("phone-body"),this.sub("inPhone",this.inPhone),this.sub("outPhone",this.outPhone),this.sub("changeSuccess",this.outPhone)},inPhone:function(){this.phoneBody.style.display="none",this.tplPrompt.style.display="block",this.tplPromptSpan.innerHTML="释放鼠标切换到<em>"+this.obj.innerHTML+"</em>模板"},outPhone:function(){this.phoneBody.style.display="block",this.tplPrompt.style.display="none",this.tplPromptSpan.innerHTML=""},mouseDownInit:function(){this.createShadow(),this.interval=!0,this.innerTop=m.getTop(this.phoneInner),this.innerBottom=this.innerTop+this.phoneInner.offsetHeight,this.phoneInnerLeft=m.getLeft(this.phoneInner),this.phoneInnerTop=m.getTop(this.phoneInner),document.body.appendChild(this.shadow),document.body.classList.add("drag-move")},createShadow:function(){with(this.shadow=this.obj.cloneNode(!0),this.shadow.style)backgroundColor="rgba(0, 0, 0, .5)",position="absolute",left=0,top=0,transition="none",zIndex=9},isInPhoneInner:function(a,b,c,d){var e=b+d.offsetWidth,f=c+d.offsetHeight;return a.clientX<b||a.clientX>e||a.clientY<d.offsetTop||a.clientY>f?!1:!0}},m.extend(Drag.prototype,new Observer),module.exports={init:init}}),define("design/js/controller/preview",["../model/data","../model/search","../tools/method","../view/dialog","../view/setting","../../../config/config","../tools/qrcode"],function(a,b,c){function d(){e()}function e(){r.addEventListener("click",function(){var a=k.getFormatData(q);f();var b="data="+encodeURIComponent(a)+"&orgid="+n.getOrgid()+"&urlprefix="+n.getUrlPrefix();p.ajax({type:"post",url:m.preview,data:b,success:g,error:h})},!1)}function f(){i=l.dialog({type:"preview"}),j=i.querySelector(".dialog-code")}function g(a){if(console.log(a),0!=a){var b=new o.QRCode(j,{width:160,height:160});b.makeCode(a)}else h()}function h(a){l.message({status:2,text:"预览失败"})}var i,j,k=a("../model/data"),l=a("../view/dialog"),m=a("../../../config/config").Path,n=a("../model/search"),o=a("../tools/qrcode"),p=a("../tools/method"),q=k.DATA,r=document.getElementById("preview");b.init=d}),define("design/js/controller/prompt",["../tools/method","../view/dialog","../view/setting"],function(a,b,c){function d(){var a=j.querySelectorAll(".phone-item");f(a),g(a),e()}function e(){var b=document.getElementById("controls"),c=!0;b.addEventListener("click",function(b){"control"===b.target.getAttribute("name")&&c&&(a("../view/dialog").message({status:2,text:"请拖动控件到手机区域"}),c=!1,setTimeout(function(){c=!0},2e3))},!1)}function f(a){a.length>0?(j.classList.remove("phone-prompt"),k.classList.remove("disabled")):(j.classList.add("phone-prompt"),k.classList.add("disabled"))}function g(a){for(var b=0;b<a.length;b++)if(a[b].dataset.type&&"detail"==a[b].dataset.type){var c=a[b].querySelector(".phone-area");a[b].querySelectorAll(".phone-item").length>0?c.classList.add("phone-area-some"):c.classList.remove("phone-area-some")}}function h(){var a=document.querySelector(".header-title");a.addEventListener("click",function(){var a=document,b=a.documentElement;a.fullscreen||a.mozFullScreen||a.webkitIsFullScreen?a.exitFullscreen?a.exitFullscreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.webkitCancelFullScreen&&a.webkitCancelFullScreen():b.requestFullscreen?b.requestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullScreen&&b.webkitRequestFullScreen()})}function i(){var a=document.createElement("script");a.src="http://s95.cnzz.com/z_stat.php?id=1258029164&web_id=1258029164",a.setAttribute("language","JavaScript"),document.body.appendChild(a),setTimeout(function(){document.body.removeChild(a)},1e3)}var j=(a("../tools/method"),document.getElementById("phone-body")),k=document.getElementById("header-actions");h(),i(),b.detection=d}),define("design/js/controller/save",["../model/data","../model/search","../tools/method","../view/dialog","../view/setting","./validation","./setting","../model/insert","../view/phone","./databind","../tools/escape","./handlers","./prompt","../model/delete","../view/load-body","../../../config/config"],function(a,b,c){function d(){document.body.addEventListener("click",function(a){var b=a.target;switch(b.dataset.action){case"save":e("save","保存",!1);break;case"last-save":f(!1);break;case"enabled":e("enabled","保存并启用",!0);break;case"last-enabled":f(!0)}},!1)}function e(a,b,c){var d=m.verify();if(d===!0)g(c);else if("show-save-dialog"==d){var e=l.dialog({type:a,btnText:b,data:k.getData(0)});e.querySelector("input:first-child").focus()}else l.message({status:2,text:d.text}),console.log(d.id),n.toFixed(d.id)}function f(a){var b=m.verify();if(b===!0)g(a);else{var c=document.getElementById("dialog-box");c.classList.add("animation-error"),setTimeout(function(){c.classList.remove("animation-zoomIn"),c.classList.remove("animation-error")},300)}}function g(a){k.updateData(0,"enabled",a);var b=(k.DATA,k.getFormatData());l.dialog({type:"loading",content:"正在保存"}),q.ajax({type:"post",url:o.template,data:"action=m.create&data="+encodeURIComponent(b)+"&orgid="+p.getOrgid(),success:function(c){console.log(c),h(c,function(c){l.message({status:1,text:"保存成功"+(a?"，该审批已启用":"")}),i(c),window.sessionStorage.setItem("default",b)},j)},error:j})}function h(a,b,c){var d=k.DATA[0],e=p.sSearch+"&tplid="+a;e+="&itemname="+d.title+"&itemdesc="+d.explain,e+="&urlprefix="+window.location.origin+window.location.pathname,e+="&isvalid="+(d.enabled?1:0),console.log(e),q.ajax({type:"post",url:o.save,data:e,success:function(a){a=JSON.parse(a),console.log(a),200==a.status?b&&b(a.oldTemplate):c(a)},error:c&&c})}function i(a){q.ajax({type:"post",url:o.template,data:"action=delete&oldTemplate="+a,success:function(a){console.log(a)},error:function(a){console.log(a)}})}function j(a){var b=a.errmsg?a.errmsg:"保存失败";l.message({status:2,text:b})}var k=a("../model/data"),l=a("../view/dialog"),m=a("./validation"),n=a("./setting").setting,o=a("../../../config/config").Path,p=a("../model/search"),q=a("../tools/method");document.getElementById("save");d()}),define("design/js/controller/setting",["../view/setting","../tools/method","../model/data","../model/search","../model/insert","../view/phone","./databind","../tools/escape","./validation","./handlers","./prompt","../view/dialog","../model/delete","../view/load-body"],function(a,b,c){var d=a("../view/setting").Templates,e=a("../model/data"),f=a("../model/insert"),g=a("./prompt"),h=a("../model/delete"),i=a("../view/dialog"),j=a("../view/load-body"),k=a("../tools/method"),l=(a("./handlers"),function(a){this.phoneBody=document.getElementById("phone-body"),this.settingWrap=document.getElementById("setting-wrap"),this.setTitle=this.settingWrap.querySelectorAll(".op-title"),this.widgeTab=this.setTitle[0],this.pageNameTab=this.setTitle[1],this.init()});l.prototype={init:function(){this.itemBind(),this.titleChange(),this.insertPageName(),this.showSetting(0,!0)},itemBind:function(){var a=this;this.phoneBody.addEventListener("click",function(b){if(b.target.classList.contains("phone-close")){var c=(b.target.parentNode.parentNode,h.deleteItem(b.target));return g.detection(),void a.onDelCur(c)}var d=k.getTarget(b.target,"name","phone-item",this);"phone-item"==d.getAttribute("name")&&a.toActive(d)})},titleChange:function(){var a=this;this.widgeTab.addEventListener("click",function(b){if(0==a.id){var c;c=e.DATA.length<=1?"请拖动控件到手机内":"请选中需要修改的控件",i.message({status:2,text:c})}else a.showSetting(a.id)},!1),this.pageNameTab.addEventListener("click",function(b){a.showSetting(0,!0)},!1)},pageNameActive:function(){this.pageNameTab.classList.add("active"),this.widgeTab.classList.remove("active")},widgetActive:function(){this.widgeTab.classList.add("active"),this.pageNameTab.classList.remove("active")},toFixed:function(a){this.getPhoneItems();for(var b=0;b<this.phoneItems.length;b++)if(parseInt(this.phoneItems[b].dataset.id)===a){this.toActive(this.phoneItems[b]);break}},toActive:function(a){this.target=a,this.getPhoneItems();for(var b=0;b<this.phoneItems.length;b++)this.phoneItems[b].classList.remove("active");this.target.classList.add("active"),this.id=this.target.dataset.id,this.showSetting(this.id)},showSetting:function(a,b){0==a?this.pageNameActive():this.widgetActive();var c=new d({data:e.getData(a),hideError:b}),f=c.getSetting(),g=this.settingWrap.querySelector(".setting-cont");g&&this.settingWrap.removeChild(g),this.settingWrap.appendChild(f)},getPhoneItems:function(){this.phoneItems=this.phoneBody.querySelectorAll('div[name="phone-item"]')},insertPageName:function(){this.id=0,f.insertPageName()},onDelCur:function(a){-1!=a.indexOf(this.id)&&(this.id=0,this.showSetting(0,!0))}};var m={oControl:document.getElementById("controls"),init:function(){this.aTit=this.transArray(this.oControl.querySelectorAll(".op-title")),this.oWidget=this.aTit[0],this.oTpl=this.aTit[1];for(var a=0;a<this.aTit.length;a++)this.aTit[a].addEventListener("click",this.changeHanlder.bind(this),!1)},transArray:function(a){return Array.prototype.slice.call(a)},changeHanlder:function(a){var b;this.hideAll(),b=a.target==this.oWidget?k.parseDOM(j.tWidget())[0]:k.parseDOM(j.tTpl())[0],this.oControl.appendChild(b),a.target.classList.add("active")},hideAll:function(){this.aCont=this.transArray(this.oControl.querySelectorAll("div[name=tpl-main]")),this.aCont.forEach(function(a){a.parentNode.removeChild(a)}),this.aTit.forEach(function(a){a.classList.remove("active")})}};m.init(),b.setting=new l}),define("design/js/controller/validation",["../model/data","../model/search","../tools/method"],function(a,b,c){function d(){for(var a=k.DATA,b=1;b<a.length;b++){var c=a[b].invalid;for(key in c)if(c[key])return{id:a[b].id,text:"组件"+m[key]+a[b].verifyText[key]};if("detail"==a[b].type){for(var d=0,e=0;e<a.length;e++)a[e].parentId==a[b].id&&d++;if(!d)return{id:a[b].id,text:"请添加组件到"+a[b].title+"中"}}}var c=a[0].invalid;for(key in c)if(c[key])return"show-save-dialog";return!0}function e(a,b,c,d){var e=l.strlen(d),h=c.validationRule[b],j=a.parentNode.previousElementSibling.querySelector(".remark"),m=!("title"!=b);return e>h?f(a,j,c,b):g(a,j,c,b),m&&(0==e?("hide"==a.dataset.error?f(a,j,c,b,!0):f(a,j,c,b),0==c.id?k.updateData(c,b,"请输入审批名称，最多10个字","verifyText"):k.updateData(c,b,"不能为空","verifyText")):0==c.id?k.updateData(c,b,"请输入审批名称，最多10个字","verifyText"):k.updateData(c,b,"最多"+h+"个字","verifyText"),j.innerHTML=c.verifyText[b]),i(c,b,a,d)}function f(a,b,c,d,e){e||(a.classList.add("error"),b.classList.add("error")),k.updateData(c,d,!0,"invalid")}function g(a,b,c,d){a.classList.remove("error"),b.classList.remove("error"),k.updateData(c,d,!1,"invalid")}function h(a){var b=a.value;if("请选择"===b||"请选择（必填）"===b)return"";var c=l.strlen(b);return c>20?l.substr(b,20):void 0}function i(a,b,c,d){return a.invalid[b]&&"pageName"!==a.type?l.substr(d,a.validationRule[b]):d}function j(a,b,c,d,f){var g=c.getAttribute("type"),h=c.tagName.toLowerCase();return("text"===g||"textarea"===h)&&(b=e(c,a,k.getData(d),b)),"checkbox"===c.getAttribute("type")&&(b=c.checked?c.dataset.trueValue:c.dataset.falseValue),"curIcon"===a&&(b=c.dataset.value,f.iconURL=c.src),b}var k=a("../model/data"),l=a("../tools/method"),m={title:"标题",prompt:"提示文字",addDetail:"动作名称"};c.exports={inputVerify:e,optionVerify:h,verify:d,DBModelVerify:j}}),define("design/js/model/data",["./search","../tools/method"],function(a,b,c){function d(a){return p}function e(a){var b=a;return b.id=p++,q.push(b),b}function f(a,b,c,d){var e;return e="object"==typeof a?a:h(a),d?e[d][b]=c:e[b]=c,e}function g(a,b,c,d){var e=h(a);"add"==c?e.options.splice(parseInt(b)+1,0,"选项"+e.optionsIndex):"delete"==c?e.options.splice(b,1):"update"==c&&(e.options[b]=d)}function h(a){for(var b=0;b<q.length;b++)if(q[b].id==a)return q[b]}function i(a){for(var b=0;b<q.length;b++)if(q[b].id==a){q.splice(b,1);break}}function j(){for(var a=[],b=0;b<q.length;b++)a.push(JSON.stringify(q[b]));return a}function k(a){var b=m.getTplPath();q[0];n.getJsonLen(o)<1?o["default"]=n.deepCopy(a):o[b]=n.deepCopy(a),q=n.deepCopy(a),c.exports.DATA=q,window.temp=q,l()}function l(){var a=0;q.forEach(function(b){a=b.id>a?b.id:a}),p=++a}var m=a("./search"),n=a("../tools/method"),o={},p=0,q=[];window.temp=q,window.temp2=p,window.cache=o,c.exports={CACHE:o,DATA:q,addNewData:e,updateData:f,updateOptions:g,getNewId:d,getData:h,deleteData:i,getFormatData:j,coverDATA:k}}),define("design/js/model/delete",["./data","./search","../tools/method"],function(a,b,c){function d(a){var b=a.parentNode.parentNode,c=b.parentNode,d=b.dataset.id,f=[];if("detail"==b.dataset.type)for(var g=e.DATA,h=0;h<g.length;h++)g[h].parentId==d&&(f.push(g[h].id),e.deleteData(g[h].id));return c.removeChild(b),f.push(d),e.deleteData(d),f.join(",")}var e=a("./data");a("../tools/method");b.deleteItem=d}),define("design/js/model/format",["./data","./search","../tools/method"],function(a,b,c){function d(a){var b;b="Array"===Object.prototype.toString.call(a).slice(8,-1)?j.deepCopy(a):e(a),i.coverDATA(b),k[-1]=b.splice(0,1);var c=f(b,0);c=g(c),k[0]=c;for(var d=0;d<c.length;d++){var a=c[d];if("detail"==a.type){var h=f(b,a.id);h=g(h),k[a.id]=h}}return k}function e(a){var b=[],c=/},{/g,d=a.replace(c,"},?&${");d=d.split(",?&$");for(var e=0;e<d.length;e++)b.push(JSON.parse(d[e]));return b}function f(a,b){for(var c=[],d=0;d<a.length;d++)a[d].parentId==b&&(c=c.concat(a.splice(d--,1)));return c}function g(a){if(a.length<=1)return a;for(var b=Math.floor(a.length/2),c=a.splice(b,1),d=c[0].order,e=[],f=[],h=0;h<a.length;h++)a[h].order<d?e.push(a[h]):f.push(a[h]);return g(e).concat(c,g(f))}function h(a){for(key in k)for(var b=k[key],c=0;c<b.length;c++)if(b[c].id==a)return b[c];return null}var i=a("./data"),j=a("../tools/method"),k={};window.tempFormat=k,b.DATA=k,b.format=d,b.getData=h}),define("design/js/model/insert",["./data","./search","../tools/method","../view/phone","../controller/databind","../tools/escape","../controller/validation","../controller/handlers","../view/setting"],function(a,b,c){function d(a){var b,c,d,e=a.dataset.type,g=f.getNewId();"dateRange"==e?(b="开始时间",c="结束时间"):b=a.innerText||a.textContent,d=-1!=i.indexOf(e)?"请输入":"image"==e?"":"请选择";var j=f.addNewData({type:e,title:b,title2:c,prompt:d,require:"",addDetail:"detail"==e?"增加明细":void 0,datetype:"date",options:"radio"==e?["选项1","选项2","选项3","选项4"]:void 0,optionsIndex:"radio"==e?4:void 0,verifyText:{title:"最多10个字",title2:"最多10个字",prompt:"最多20个字",addDetail:"最多10个字"},validationRule:{title:10,title2:10,prompt:20,addDetail:10},invalid:{title:!1,title2:!1,prompt:!1,addDetail:!1}});return h.DBModel(j.id,function(a){return j}),g}function e(){for(var a=[],b=1;17>b;b++)a.push(b+".png");f.addNewData({type:"pageName",title:"",explain:"",icons:a,curIcon:1,iconURL:g.getIconURL(1),enabled:!1,verifyText:{title:"请输入审批名称，最多10个字",explain:"最多100个字"},validationRule:{title:10,explain:100},invalid:{title:!0,explain:!1}})}var f=a("./data"),g=(a("../view/phone").Templates,a("../tools/method"),a("./search")),h=a("../controller/databind"),i=["text","textarea","number"].join("");b.insertNewItem=d,b.insertPageName=e}),define("design/js/model/search",["../tools/method"],function(a,b){function c(a){var b=window.location[a];if(-1!=b.indexOf("?")){var c=b.m.substr(1),d=/&{0,1}tplid=[\w | . | \/]*/,e=/&&/,f=/^&/;return c=c.replace(d,""),c=c.replace(e,"&"),c=c.replace(f,"")}if(-1!=b.indexOf("#")){var c=b.m.substr(1);return c}return null}function d(a){for(var b={},c=a.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");b[e[0]]=e[1]}return b}function e(){return window.location.hash.substring(1)}function f(){var a=window.location.origin+window.location.pathname;return a.substring(0,a.lastIndexOf("/")+1)}function g(){var a=".vs";return i&&i.orgid&&(a=i.orgid),a}function h(a){return f()+"design/images/app/"+a+".png"}var i,j=c("search");a("../tools/method");null!==j&&(i=d(j)),b.sSearch=j,b.oSearch=i,b.getTplPath=e,b.getUrlPrefix=f,b.getOrgid=g,b.getIconURL=h}),define("design/js/tools/escape",[],function(a,b,c){function d(a){return"string"!=typeof a?"":a.replace(i.escape,function(a){return h.escape[a]})}function e(a){return"string"!=typeof a?"":a.replace(i.unescape,function(a){return h.unescape[a]})}var f=Object.keys||function(a){a=Object(a);var b=[];for(var c in a)b.push(c);return b},g=function(a){a=Object(a);var b={};for(var c in a)b[a[c]]=c;return b},h={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"}};h.unescape=g(h.escape);var i={escape:RegExp("["+f(h.escape).join("")+"]","g"),unescape:RegExp("("+f(h.unescape).join("|")+")","g")};c.exports={escape:d,unescape:e}}),define("design/js/tools/method",[],function(a,b,c){function d(a){var b=a.offsetTop;return null!=a.offsetParent&&(b+=d(a.offsetParent)),b}function e(a){var b=a.offsetLeft;return null!=a.offsetParent&&(b+=e(a.offsetParent)),b}function f(a){return document.createElement(a)}function g(a,b,c,d){var e=a;if(e==d)return e;for(;e.getAttribute(b)!=c&&e.parentNode!=d;)e=e.parentNode;return e}function h(a){var b=document.createElement("div");return b.innerHTML=a,b.childNodes}function i(a,b){var c=b.parentNode;b==c.lastChild?c.insertBefore(a,null):c.insertBefore(a,b.nextSibling)}function j(a,b){return"function"==typeof a.contains?a.contains(b):"function"==typeof a.compareDocumentPosition?!!(16&a.compareDocumentPosition(b)):void 0}function k(a,b){for(var c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);if(c+=e>=1&&126>=e||e>=65376&&65439>=e?.5:1,c>=b){var f=c==b?d+1:d;return a.substr(0,f)}}return a}function l(a){for(var b=0,c=0;c<a.length;c++){var d=a.charCodeAt(c);d>=1&&126>=d||d>=65376&&65439>=d?b++:b+=2}return Math.ceil(b/2)}function m(a){var b=f("script");b.src=a,document.body.appendChild(b)}function n(a){var b,c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c)b={};else{if("Array"!==c)return a;b=[]}for(var d in a)b[d]=n(a[d]);return b}function o(a){a.beforeSend&&a.beforeSend(),xhr=new XMLHttpRequest,"post"!=a.type&&(a.type="get",a.data&&(a.url+="?"+a.data)),xhr.open(a.type,a.url,!0),"get"==a.type?xhr.send():(xhr.setRequestHeader("content-type","application/x-www-form-urlencoded"),xhr.send(a.data)),xhr.onreadystatechange=function(){4==xhr.readyState&&(200==xhr.status?a.success&&a.success(xhr.responseText):a.error&&a.error(xhr.status))}}function p(a){var b=0;for(var c in a)a.hasOwnProperty(c)&&b++;return b}function q(a,b){for(var c in b)a[c]=b[c];return a}c.exports={getTop:d,getLeft:e,create:f,getTarget:g,parseDOM:h,insertAfter:i,DomContains:j,substr:k,strlen:l,loadHtml:m,deepCopy:n,ajax:o,getJsonLen:p,extend:q}}),define("design/js/tools/observer",[],function(){var a={on:function(a,b){this.listeners=this.listeners||{},this.listeners[a]=this.listeners[a]||[],this.listeners[a].push(b)},one:function(a,b){this.on(a,function c(d){b.call(this,d),this.unbind(a,c)})},trigger:function(a,b){if(this.listeners&&this.listeners[a])for(var c=0;c<this.listeners[a].length;c++)this.listeners[a][c].call(this,b)},unbind:function(a,b){if(this.listeners&&this.listeners[a])if("function"!=typeof b)delete this.listeners[a];else{for(var c=0;c<this.listeners[a].length;c++)this.listeners[a][c]===b&&this.listeners[a].splice(c--,1);this.listeners[a].length||delete this.listeners[a]}}};return function(){this.sub=this.on=a.on,this.pub=this.trigger=a.trigger,this.one=a.one,this.unsub=this.unbind=a.unbind}}),define("design/js/tools/qrcode",[],function(a,b,c){var d;!function(){
function a(a){this.mode=k.MODE_8BIT_BYTE,this.data=a,this.parsedData=[];for(var b=0,c=this.data.length;c>b;b++){var d=[],e=this.data.charCodeAt(b);e>65536?(d[0]=240|(1835008&e)>>>18,d[1]=128|(258048&e)>>>12,d[2]=128|(4032&e)>>>6,d[3]=128|63&e):e>2048?(d[0]=224|(61440&e)>>>12,d[1]=128|(4032&e)>>>6,d[2]=128|63&e):e>128?(d[0]=192|(1984&e)>>>6,d[1]=128|63&e):d[0]=e,this.parsedData.push(d)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function b(a,b){this.typeNumber=a,this.errorCorrectLevel=b,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function c(a,b){if(void 0==a.length)throw new Error(a.length+"/"+b);for(var c=0;c<a.length&&0==a[c];)c++;this.num=new Array(a.length-c+b);for(var d=0;d<a.length-c;d++)this.num[d]=a[d+c]}function e(a,b){this.totalCount=a,this.dataCount=b}function f(){this.buffer=[],this.length=0}function g(){return"undefined"!=typeof CanvasRenderingContext2D}function h(){var a=!1,b=navigator.userAgent;return/android/i.test(b)&&(a=!0,aMat=b.toString().match(/android ([0-9]\.[0-9])/i),aMat&&aMat[1]&&(a=parseFloat(aMat[1]))),a}function i(a,b){for(var c=1,d=j(a),e=0,f=q.length;f>=e;e++){var g=0;switch(b){case l.L:g=q[e][0];break;case l.M:g=q[e][1];break;case l.Q:g=q[e][2];break;case l.H:g=q[e][3]}if(g>=d)break;c++}if(c>q.length)throw new Error("Too long data");return c}function j(a){var b=encodeURI(a).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return b.length+(b.length!=a?3:0)}a.prototype={getLength:function(a){return this.parsedData.length},write:function(a){for(var b=0,c=this.parsedData.length;c>b;b++)a.put(this.parsedData[b],8)}},b.prototype={addData:function(b){var c=new a(b);this.dataList.push(c),this.dataCache=null},isDark:function(a,b){if(0>a||this.moduleCount<=a||0>b||this.moduleCount<=b)throw new Error(a+","+b);return this.modules[a][b]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(a,c){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++){this.modules[d]=new Array(this.moduleCount);for(var e=0;e<this.moduleCount;e++)this.modules[d][e]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(a,c),this.typeNumber>=7&&this.setupTypeNumber(a),null==this.dataCache&&(this.dataCache=b.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,c)},setupPositionProbePattern:function(a,b){for(var c=-1;7>=c;c++)if(!(-1>=a+c||this.moduleCount<=a+c))for(var d=-1;7>=d;d++)-1>=b+d||this.moduleCount<=b+d||(c>=0&&6>=c&&(0==d||6==d)||d>=0&&6>=d&&(0==c||6==c)||c>=2&&4>=c&&d>=2&&4>=d?this.modules[a+c][b+d]=!0:this.modules[a+c][b+d]=!1)},getBestMaskPattern:function(){for(var a=0,b=0,c=0;8>c;c++){this.makeImpl(!0,c);var d=n.getLostPoint(this);(0==c||a>d)&&(a=d,b=c)}return b},createMovieClip:function(a,b,c){var d=a.createEmptyMovieClip(b,c),e=1;this.make();for(var f=0;f<this.modules.length;f++)for(var g=f*e,h=0;h<this.modules[f].length;h++){var i=h*e,j=this.modules[f][h];j&&(d.beginFill(0,100),d.moveTo(i,g),d.lineTo(i+e,g),d.lineTo(i+e,g+e),d.lineTo(i,g+e),d.endFill())}return d},setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++)null==this.modules[a][6]&&(this.modules[a][6]=a%2==0);for(var b=8;b<this.moduleCount-8;b++)null==this.modules[6][b]&&(this.modules[6][b]=b%2==0)},setupPositionAdjustPattern:function(){for(var a=n.getPatternPosition(this.typeNumber),b=0;b<a.length;b++)for(var c=0;c<a.length;c++){var d=a[b],e=a[c];if(null==this.modules[d][e])for(var f=-2;2>=f;f++)for(var g=-2;2>=g;g++)-2==f||2==f||-2==g||2==g||0==f&&0==g?this.modules[d+f][e+g]=!0:this.modules[d+f][e+g]=!1}},setupTypeNumber:function(a){for(var b=n.getBCHTypeNumber(this.typeNumber),c=0;18>c;c++){var d=!a&&1==(b>>c&1);this.modules[Math.floor(c/3)][c%3+this.moduleCount-8-3]=d}for(var c=0;18>c;c++){var d=!a&&1==(b>>c&1);this.modules[c%3+this.moduleCount-8-3][Math.floor(c/3)]=d}},setupTypeInfo:function(a,b){for(var c=this.errorCorrectLevel<<3|b,d=n.getBCHTypeInfo(c),e=0;15>e;e++){var f=!a&&1==(d>>e&1);6>e?this.modules[e][8]=f:8>e?this.modules[e+1][8]=f:this.modules[this.moduleCount-15+e][8]=f}for(var e=0;15>e;e++){var f=!a&&1==(d>>e&1);8>e?this.modules[8][this.moduleCount-e-1]=f:9>e?this.modules[8][15-e-1+1]=f:this.modules[8][15-e-1]=f}this.modules[this.moduleCount-8][8]=!a},mapData:function(a,b){for(var c=-1,d=this.moduleCount-1,e=7,f=0,g=this.moduleCount-1;g>0;g-=2)for(6==g&&g--;;){for(var h=0;2>h;h++)if(null==this.modules[d][g-h]){var i=!1;f<a.length&&(i=1==(a[f]>>>e&1));var j=n.getMask(b,d,g-h);j&&(i=!i),this.modules[d][g-h]=i,e--,-1==e&&(f++,e=7)}if(d+=c,0>d||this.moduleCount<=d){d-=c,c=-c;break}}}},b.PAD0=236,b.PAD1=17,b.createData=function(a,c,d){for(var g=e.getRSBlocks(a,c),h=new f,i=0;i<d.length;i++){var j=d[i];h.put(j.mode,4),h.put(j.getLength(),n.getLengthInBits(j.mode,a)),j.write(h)}for(var k=0,i=0;i<g.length;i++)k+=g[i].dataCount;if(h.getLengthInBits()>8*k)throw new Error("code length overflow. ("+h.getLengthInBits()+">"+8*k+")");for(h.getLengthInBits()+4<=8*k&&h.put(0,4);h.getLengthInBits()%8!=0;)h.putBit(!1);for(;!(h.getLengthInBits()>=8*k)&&(h.put(b.PAD0,8),!(h.getLengthInBits()>=8*k));)h.put(b.PAD1,8);return b.createBytes(h,g)},b.createBytes=function(a,b){for(var d=0,e=0,f=0,g=new Array(b.length),h=new Array(b.length),i=0;i<b.length;i++){var j=b[i].dataCount,k=b[i].totalCount-j;e=Math.max(e,j),f=Math.max(f,k),g[i]=new Array(j);for(var l=0;l<g[i].length;l++)g[i][l]=255&a.buffer[l+d];d+=j;var m=n.getErrorCorrectPolynomial(k),o=new c(g[i],m.getLength()-1),p=o.mod(m);h[i]=new Array(m.getLength()-1);for(var l=0;l<h[i].length;l++){var q=l+p.getLength()-h[i].length;h[i][l]=q>=0?p.get(q):0}}for(var r=0,l=0;l<b.length;l++)r+=b[l].totalCount;for(var s=new Array(r),t=0,l=0;e>l;l++)for(var i=0;i<b.length;i++)l<g[i].length&&(s[t++]=g[i][l]);for(var l=0;f>l;l++)for(var i=0;i<b.length;i++)l<h[i].length&&(s[t++]=h[i][l]);return s};for(var k={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},l={L:1,M:0,Q:3,H:2},m={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},n={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){for(var b=a<<10;n.getBCHDigit(b)-n.getBCHDigit(n.G15)>=0;)b^=n.G15<<n.getBCHDigit(b)-n.getBCHDigit(n.G15);return(a<<10|b)^n.G15_MASK},getBCHTypeNumber:function(a){for(var b=a<<12;n.getBCHDigit(b)-n.getBCHDigit(n.G18)>=0;)b^=n.G18<<n.getBCHDigit(b)-n.getBCHDigit(n.G18);return a<<12|b},getBCHDigit:function(a){for(var b=0;0!=a;)b++,a>>>=1;return b},getPatternPosition:function(a){return n.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,b,c){switch(a){case m.PATTERN000:return(b+c)%2==0;case m.PATTERN001:return b%2==0;case m.PATTERN010:return c%3==0;case m.PATTERN011:return(b+c)%3==0;case m.PATTERN100:return(Math.floor(b/2)+Math.floor(c/3))%2==0;case m.PATTERN101:return b*c%2+b*c%3==0;case m.PATTERN110:return(b*c%2+b*c%3)%2==0;case m.PATTERN111:return(b*c%3+(b+c)%2)%2==0;default:throw new Error("bad maskPattern:"+a)}},getErrorCorrectPolynomial:function(a){for(var b=new c([1],0),d=0;a>d;d++)b=b.multiply(new c([1,o.gexp(d)],0));return b},getLengthInBits:function(a,b){if(b>=1&&10>b)switch(a){case k.MODE_NUMBER:return 10;case k.MODE_ALPHA_NUM:return 9;case k.MODE_8BIT_BYTE:return 8;case k.MODE_KANJI:return 8;default:throw new Error("mode:"+a)}else if(27>b)switch(a){case k.MODE_NUMBER:return 12;case k.MODE_ALPHA_NUM:return 11;case k.MODE_8BIT_BYTE:return 16;case k.MODE_KANJI:return 10;default:throw new Error("mode:"+a)}else{if(!(41>b))throw new Error("type:"+b);switch(a){case k.MODE_NUMBER:return 14;case k.MODE_ALPHA_NUM:return 13;case k.MODE_8BIT_BYTE:return 16;case k.MODE_KANJI:return 12;default:throw new Error("mode:"+a)}}},getLostPoint:function(a){for(var b=a.getModuleCount(),c=0,d=0;b>d;d++)for(var e=0;b>e;e++){for(var f=0,g=a.isDark(d,e),h=-1;1>=h;h++)if(!(0>d+h||d+h>=b))for(var i=-1;1>=i;i++)0>e+i||e+i>=b||(0!=h||0!=i)&&g==a.isDark(d+h,e+i)&&f++;f>5&&(c+=3+f-5)}for(var d=0;b-1>d;d++)for(var e=0;b-1>e;e++){var j=0;a.isDark(d,e)&&j++,a.isDark(d+1,e)&&j++,a.isDark(d,e+1)&&j++,a.isDark(d+1,e+1)&&j++,(0==j||4==j)&&(c+=3)}for(var d=0;b>d;d++)for(var e=0;b-6>e;e++)a.isDark(d,e)&&!a.isDark(d,e+1)&&a.isDark(d,e+2)&&a.isDark(d,e+3)&&a.isDark(d,e+4)&&!a.isDark(d,e+5)&&a.isDark(d,e+6)&&(c+=40);for(var e=0;b>e;e++)for(var d=0;b-6>d;d++)a.isDark(d,e)&&!a.isDark(d+1,e)&&a.isDark(d+2,e)&&a.isDark(d+3,e)&&a.isDark(d+4,e)&&!a.isDark(d+5,e)&&a.isDark(d+6,e)&&(c+=40);for(var k=0,e=0;b>e;e++)for(var d=0;b>d;d++)a.isDark(d,e)&&k++;var l=Math.abs(100*k/b/b-50)/5;return c+=10*l}},o={glog:function(a){if(1>a)throw new Error("glog("+a+")");return o.LOG_TABLE[a]},gexp:function(a){for(;0>a;)a+=255;for(;a>=256;)a-=255;return o.EXP_TABLE[a]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},p=0;8>p;p++)o.EXP_TABLE[p]=1<<p;for(var p=8;256>p;p++)o.EXP_TABLE[p]=o.EXP_TABLE[p-4]^o.EXP_TABLE[p-5]^o.EXP_TABLE[p-6]^o.EXP_TABLE[p-8];for(var p=0;255>p;p++)o.LOG_TABLE[o.EXP_TABLE[p]]=p;c.prototype={get:function(a){return this.num[a]},getLength:function(){return this.num.length},multiply:function(a){for(var b=new Array(this.getLength()+a.getLength()-1),d=0;d<this.getLength();d++)for(var e=0;e<a.getLength();e++)b[d+e]^=o.gexp(o.glog(this.get(d))+o.glog(a.get(e)));return new c(b,0)},mod:function(a){if(this.getLength()-a.getLength()<0)return this;for(var b=o.glog(this.get(0))-o.glog(a.get(0)),d=new Array(this.getLength()),e=0;e<this.getLength();e++)d[e]=this.get(e);for(var e=0;e<a.getLength();e++)d[e]^=o.gexp(o.glog(a.get(e))+b);return new c(d,0).mod(a)}},e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(a,b){var c=e.getRsBlockTable(a,b);if(void 0==c)throw new Error("bad rs block @ typeNumber:"+a+"/errorCorrectLevel:"+b);for(var d=c.length/3,f=[],g=0;d>g;g++)for(var h=c[3*g+0],i=c[3*g+1],j=c[3*g+2],k=0;h>k;k++)f.push(new e(i,j));return f},e.getRsBlockTable=function(a,b){switch(b){case l.L:return e.RS_BLOCK_TABLE[4*(a-1)+0];case l.M:return e.RS_BLOCK_TABLE[4*(a-1)+1];case l.Q:return e.RS_BLOCK_TABLE[4*(a-1)+2];case l.H:return e.RS_BLOCK_TABLE[4*(a-1)+3];default:return void 0}},f.prototype={get:function(a){var b=Math.floor(a/8);return 1==(this.buffer[b]>>>7-a%8&1)},put:function(a,b){for(var c=0;b>c;c++)this.putBit(1==(a>>>b-c-1&1))},getLengthInBits:function(){return this.length},putBit:function(a){var b=Math.floor(this.length/8);this.buffer.length<=b&&this.buffer.push(0),a&&(this.buffer[b]|=128>>>this.length%8),this.length++}};var q=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],r=function(){var a=function(a,b){this._el=a,this._htOption=b};return a.prototype.draw=function(a){function b(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg",a);for(var d in b)b.hasOwnProperty(d)&&c.setAttribute(d,b[d]);return c}var c=this._htOption,d=this._el,e=a.getModuleCount();Math.floor(c.width/e),Math.floor(c.height/e);this.clear();var f=b("svg",{viewBox:"0 0 "+String(e)+" "+String(e),width:"100%",height:"100%",fill:c.colorLight});f.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),d.appendChild(f),f.appendChild(b("rect",{fill:c.colorDark,width:"1",height:"1",id:"template"}));for(var g=0;e>g;g++)for(var h=0;e>h;h++)if(a.isDark(g,h)){var i=b("use",{x:String(g),y:String(h)});i.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),f.appendChild(i)}},a.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},a}(),s="svg"===document.documentElement.tagName.toLowerCase(),t=s?r:g()?function(){function a(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function b(a,b){var c=this;if(c._fFail=b,c._fSuccess=a,null===c._bSupportDataURI){var d=document.createElement("img"),e=function(){c._bSupportDataURI=!1,c._fFail&&_fFail.call(c)},f=function(){c._bSupportDataURI=!0,c._fSuccess&&c._fSuccess.call(c)};return d.onabort=e,d.onerror=e,d.onload=f,void(d.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}c._bSupportDataURI===!0&&c._fSuccess?c._fSuccess.call(c):c._bSupportDataURI===!1&&c._fFail&&c._fFail.call(c)}if(this._android&&this._android<=2.1){var c=1/window.devicePixelRatio,d=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(a,b,e,f,g,h,i,j,k){if("nodeName"in a&&/img/i.test(a.nodeName))for(var l=arguments.length-1;l>=1;l--)arguments[l]=arguments[l]*c;else"undefined"==typeof j&&(arguments[1]*=c,arguments[2]*=c,arguments[3]*=c,arguments[4]*=c);d.apply(this,arguments)}}var e=function(a,b){this._bIsPainted=!1,this._android=h(),this._htOption=b,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=b.width,this._elCanvas.height=b.height,a.appendChild(this._elCanvas),this._el=a,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return e.prototype.draw=function(a){var b=this._elImage,c=this._oContext,d=this._htOption,e=a.getModuleCount(),f=d.width/e,g=d.height/e,h=Math.round(f),i=Math.round(g);b.style.display="none",this.clear();for(var j=0;e>j;j++)for(var k=0;e>k;k++){var l=a.isDark(j,k),m=k*f,n=j*g;c.strokeStyle=l?d.colorDark:d.colorLight,c.lineWidth=1,c.fillStyle=l?d.colorDark:d.colorLight,c.fillRect(m,n,f,g),c.strokeRect(Math.floor(m)+.5,Math.floor(n)+.5,h,i),c.strokeRect(Math.ceil(m)-.5,Math.ceil(n)-.5,h,i)}this._bIsPainted=!0},e.prototype.makeImage=function(){this._bIsPainted&&b.call(this,a)},e.prototype.isPainted=function(){return this._bIsPainted},e.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},e.prototype.round=function(a){return a?Math.floor(1e3*a)/1e3:a},e}():function(){var a=function(a,b){this._el=a,this._htOption=b};return a.prototype.draw=function(a){for(var b=this._htOption,c=this._el,d=a.getModuleCount(),e=Math.floor(b.width/d),f=Math.floor(b.height/d),g=['<table style="border:0;border-collapse:collapse;">'],h=0;d>h;h++){g.push("<tr>");for(var i=0;d>i;i++)g.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+e+"px;height:"+f+"px;background-color:"+(a.isDark(h,i)?b.colorDark:b.colorLight)+';"></td>');g.push("</tr>")}g.push("</table>"),c.innerHTML=g.join("");var j=c.childNodes[0],k=(b.width-j.offsetWidth)/2,l=(b.height-j.offsetHeight)/2;k>0&&l>0&&(j.style.margin=l+"px "+k+"px")},a.prototype.clear=function(){this._el.innerHTML=""},a}();d=function(a,b){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:l.H},"string"==typeof b&&(b={text:b}),b)for(var c in b)this._htOption[c]=b[c];"string"==typeof a&&(a=document.getElementById(a)),this._android=h(),this._el=a,this._oQRCode=null,this._oDrawing=new t(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},d.prototype.makeCode=function(a){this._oQRCode=new b(i(a,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(a),this._oQRCode.make(),this._el.title=a,this._oDrawing.draw(this._oQRCode),this.makeImage()},d.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},d.prototype.clear=function(){this._oDrawing.clear()},d.CorrectLevel=l}(),b.QRCode=d}),define("design/js/view/dialog",["./setting","../tools/method"],function(a,b,c){function d(a){i(),o=a;var b=f();return document.body.appendChild(b),r.classList.add("filter"),b}function e(a){i(),o=a;var b=q.parseDOM(j("dialog-message",m))[0];return document.body.appendChild(b),g(b),b}function f(){var a,b=q.create("div");switch(b.classList.add("dialog-mask"),b.id="dialog-mask",o.type){case"preview":a=j("dialog-preview animation-slideDown",k);break;case"save":a=j("dialog-box animation-zoomIn",l,"保存");break;case"enabled":a=j("dialog-box animation-zoomIn",l,"保存并启用");break;case"loading":a=j("dialog-loading",n)}return b.innerHTML=a,b}function g(a){setTimeout(function(){q.DomContains(document.body,a)&&document.body.removeChild(a)},o.time||2e3)}function h(){document.addEventListener("click",function(a){(a.target.classList.contains("dialog-close")||a.target.classList.contains("btn-cancel"))&&i()},!1)}function i(){var a=document.getElementById("dialog-mask"),b=document.getElementById("dialog-box"),c=document.getElementById("wrapper"),d=document.body;q.DomContains(d,a)&&document.body.removeChild(a),q.DomContains(d,b)&&b.parentNode.removeChild(b),c.classList.remove("filter")}function j(a,b,c){return['<div class="'+a+'" id="dialog-box">','<i class="dialog-close"></i>',c?'<h2 class="dialog-title">'+c+"</h2>":"",'<div class="dialog-main">',b(),"</div>","</div>"].join("")}function k(){return['<h2 class="dialog-code-title">请用手机扫描二维码浏览</h2>','<div class="dialog-code"></div>','<div class="dialog-btn-wrap">','<button class="btn-save" data-action="save">保存</button>','<button class="btn-enabled" data-action="enabled">保存并启用</button>',"</div>"].join("")}function l(){var a=new p.Templates({data:o.data}),b=a.getPageName();return[b,'<div class="dialog-btn-wrap">','<button class="btn-'+o.type+'" data-action="last-'+o.type+'">'+o.btnText+"</button>",'<button class="btn-cancel">取消</button>',"</div>"].join("")}function m(){return['<i class="'+(1==o.status?"message-success":"message-error")+'"></i>','<span class="message-text">'+o.text+"</span>"].join("")}function n(){return['<i class="loading"></i>','<span class="text">'+o.content+"</span>"].join("")}var o,p=a("./setting"),q=a("../tools/method"),r=document.getElementById("wrapper");h(),b.dialog=d,b.message=e,b.closeAll=i}),define("design/js/view/load-body",[],function(a,b,c){function d(){var a='<div class="controls" name="tpl-main">';return h.forEach(function(b){a+='<span class="control-item" name="control" data-type="'+b.type+'">'+b.name+'<i class="i-'+b.type+'"></i></span>'}),a+="</div>"}function e(){return'<div name="phone-item" data-role="placeholder"></div>'}function f(){var a='<div class="templates" name="tpl-main" id="tpl-wrap">';return i.forEach(function(b){a+='<a href="#'+b.path+'" class="tpl-item" data-name="tpl">'+b.name+"</a>"}),a+="</div>"}function g(a){var b;return i.forEach(function(c){return c.path==a?void(b=c.name):void 0}),b}var h=[{type:"text",name:"单行输入框"},{type:"textarea",name:"多行输入框"},{type:"number",name:"数字输入框"},{type:"radio",name:"单选框"},{type:"date",name:"日期"},{type:"dateRange",name:"日期区间"},{type:"image",name:"图片"},{type:"detail",name:"明细"}],i=[{path:"default",name:"最近一次保存的"},{path:".tpl/empty",name:"空模板"},{path:".tpl/conversion",name:"转正申请"},{path:".tpl/seal",name:"用印盖章"},{path:".tpl/consuming",name:"物品领用"},{path:".tpl/dimission",name:"离职"},{path:".tpl/evection",name:"出差"},{path:".tpl/gotout",name:"外出"},{path:".tpl/overtime",name:"加班"},{path:".tpl/payment",name:"支付"},{path:".tpl/recruit",name:"招聘"},{path:".tpl/reimburse",name:"报销"},{path:".tpl/leave",name:"请假"},{path:".tpl/123456789",name:"加载失败"}],j=['<section id="wrapper">','<header class="header">','<h1 class="header-title">审批设计器</h1>','<div class="header-actions" id="header-actions">','<button class="btn-preview" id="preview">预览</button>','<button class="btn-save" data-action="save">保存</button>','<button class="btn-enabled" data-action="enabled">保存并启用</button>',"</div>","</header>",'<section class="main">','<section class="control-wrap" id="controls">',"<div>",'<a href="javascript:void(0)" class="op-title active">控件</a>','<a href="javascript:void(0)" class="op-title">云模板</a>',"</div>",d(h),"</section>",'<section class="phone-wrap">','<div class="phone-inner" id="phone-inner">','<div class="phone-body" id="phone-body">',e(),"</div>",'<div class="phone-tpl-prompt"><span></span></div>',"</div>","</section>",'<aside class="setting-wrap" id="setting-wrap">','<div class="setting-tab" id="setting-tab">','<a href="javascript:void(0)" class="op-title">控件设置</a>','<a href="javascript:void(0)" class="op-title active">审批设置</a>',"</div>","</aside>","</section>","</section>"].join("");document.body.innerHTML+=j,b.tPlaceholder=e,b.tWidget=d,b.tTpl=f,b.getTplName=g}),define("design/js/view/load-brower",[],function(a,b,c){function d(a){for(var b="",c=0;c<a.length;c++)b+=['<a href="'+a[c].link+'">','<img src="'+a[c].src+'" alt="下载'+a[c].name+'浏览器" />',"<span>"+a[c].name+"</span>","</a>"].join("");return b}var e=[{name:"Chrome",link:"https://www.google.com/chrome/",src:"design/images/brower/chrome.png"},{name:"Safari",link:"https://www.apple.com/cn/safari/",src:"design/images/brower/safari.png"},{name:"Firefox",link:"https://www.mozilla.org/zh-CN/firefox/new/",src:"design/images/brower/firefox.png"},{name:"Internet Explorer 11",link:"http://windows.microsoft.com/zh-cn/internet-explorer/ie-11-worldwide-languages",src:"design/images/brower/ie.png"}],f=['<div class="brower-wrapper">',"<h1>","很抱歉您目前使用的浏览器无法完整支持审批设计器，<br />","为了保证您的使用效果，请下载并安装以下任一最新版本的浏览器。","</h1>",'<div class="brower-main">',d(e),"</div>","</div>"].join("");document.body.innerHTML+=f}),define("design/js/view/phone",["../tools/method"],function(a,b,c){function d(a){var b=new f(a);return b.getPhoneItem()}var e=a("../tools/method"),f=function(a){this.param=a};f.prototype={getPhoneItem:function(){return this.createPhoneItem(),this.createClose(),this.switchItem(),this.item},createPhoneItem:function(){this.createTag("item","div","phone-item"),this.item.setAttribute("name","phone-item"),this.item.classList.add("phone-item-"+this.param.type),this.item.dataset.type=this.param.type,this.item.dataset.id=this.param.id},createClose:function(){this.createTag("overlay","div","phone-overlay",this.item),this.createTag("close","div","phone-close",this.overlay)},switchItem:function(){switch(this.param.type){case"dateRange":this.createDateRangeView();break;case"detail":this.createDetailView();break;default:this.createPlainView()}},createPlainView:function(){this.createTag("view","div","phone-view",this.item),this.createBorder(),this.label.innerHTML=this.param.title,this.prompt.innerHTML=this.param.prompt},createDateRangeView:function(){this.createTag("view","div","phone-view",this.item),this.createBorder(),this.createTag("borderEnd","div","phone-border",this.view),this.createTag("labelEnd","label","phone-label",this.borderEnd,"title2"),this.createTag("placeholderEnd","span","phone-placeholder",this.borderEnd),this.createTag("promptEnd","span","",this.placeholderEnd,"prompt"),this.createTag("requireEnd","span","",this.placeholderEnd,"require"),this.label.innerHTML=this.param.title?this.param.title:"开始时间",this.labelEnd.innerHTML=this.param.title2?this.param.title2:"结束时间",this.prompt.innerHTML=this.promptEnd.innerHTML="请选择",this.requireEnd.innerHTML=this.param.require},createDetailView:function(){this.createTag("view","div","phone-view",this.item),this.createTag("title","label","phone-item-title",this.view,"title"),this.createTag("area","div","phone-area",this.view),this.createTag("prompt","div","phone-area-prompt",this.area),this.createTag("name_item","div","",this.area),this.createTag("addDetail","div","phone-addDetail",this.view,"addDetail"),this.title.innerHTML=this.param.title,this.prompt.innerHTML="可以拖入多个组件（不包含明细组件）",this.name_item.setAttribute("name","phone-item"),this.name_item.dataset.role="area",this.addDetail.innerHTML="增加明细"},createBorder:function(){this.createTag("border","div","phone-border",this.view),this.createTag("label","label","phone-label",this.border,"title"),this.createTag("placeholder","span","phone-placeholder",this.border),this.createTag("prompt","span","",this.placeholder,"prompt"),this.createTag("require","span","",this.placeholder,"require"),this.require.innerHTML=this.param.require},createTag:function(a,b,c,d,f){this[a]=e.create(b),c&&this[a].classList.add(c),d&&d.appendChild(this[a]),f&&this[a].setAttribute("data-bind-"+this.param.id,f)}},b.Templates=f,b.createWidget=d}),define("design/js/view/setting",["../tools/method"],function(a,b,c){var d=a("../tools/method"),e=function(a){this.data=a.data,this.hideError=a.hideError};e.prototype={getSetting:function(){return this.createSetting(),this.setting},createSetting:function(){switch(this.createTag("setting","div","setting-cont"),this.setting.dataset.id=this.data.id,this.data.type){case"pageName":this.createPageName();break;case"image":this.createIamge();break;case"detail":this.createDetail();break;case"date":this.createDate();break;case"dateRange":this.createDateRange();break;case"radio":this.createRadio();break;default:this.createPlain()}},createPlain:function(){var a=this.tTitleGroup();a+=this.tTitle("提示文字",this.data.verifyText.prompt,this.data.invalid.prompt)+this.tText("prompt",this.data.prompt,this.data.invalid.prompt),a+=this.tTitle("验证","")+this.tRequire(),this.setting.innerHTML+=a},createIamge:function(){var a=this.tTitleGroup();a+=this.tTitle("验证","")+this.tRequire(),this.setting.innerHTML+=a},createDetail:function(){var a=this.tTitleGroup();a+=this.tTitle("动作名称","最多10个字")+this.tText("addDetail",this.data.addDetail,this.data.invalid.addDetail),this.setting.innerHTML+=a},createDate:function(){var a=this.tTitleGroup();a+=this.tTitle("日期类型","")+this.tDataType(),a+=this.tTitle("验证","")+this.tRequire(),this.setting.innerHTML+=a},createDateRange:function(){var a=this.tTitle("标题1",this.data.verifyText.title,this.data.invalid.title)+this.tText("title",this.data.title,this.data.invalid.title);a+=this.tTitle("标题2",this.data.verifyText.title2,this.data.invalid.title2)+this.tText("title2",this.data.title2,this.data.invalid.title2),a+=this.tTitle("日期类型","")+this.tDataType(),a+=this.tTitle("验证","")+this.tRequire(),this.setting.innerHTML+=a},createRadio:function(){var a=this.tTitleGroup();a+=this.tTitle("选项","最多200项，每项最多20个字")+this.tOptionGroup(),a+=this.tTitle("验证","")+this.tRequire(),this.setting.innerHTML+=a},createPageName:function(){this.setting.innerHTML+=this.getPageName()},getPageName:function(){var a=this.hideError&&d.strlen(this.data.title)<10,b=this.data.invalid.title,c=this.data.invalid.explain,e=this.tTitle("审批名称",this.data.verifyText.title,a?!1:b);return e+=this.tText("title",this.data.title,a?!1:b),e+=this.tTitle("审批说明",this.data.verifyText.explain,c),e+=this.tTextarea("explain",this.data.explain,c),e+=this.tTitle("图标","")+this.tIcon("curIcon"),'<div data-id="'+this.data.id+'">'+e+"</div>"},tTitleGroup:function(){return this.tTitle("标题",this.data.verifyText.title,this.data.invalid.title)+this.tText("title",this.data.title,this.data.invalid.title)},tOptionGroup:function(){for(var a="",b=0;b<this.data.options.length;b++)a+=this.tOption(this.data.options[b],b);return this.tItem(a)},tTitle:function(a,b,c){return['<div class="setting-title">','<span class="tit">'+a+"</span>",'<span class="remark '+(c?"error":"")+'">'+b+"</span>","</div>"].join("")},tText:function(a,b,c){var d=this.hideError?'data-error="hide"':"",e="data-bind-"+this.data.id+'="'+a+'"';return this.tItem('<input type="text" class="setting-text '+(c?"error":"")+'"'+d+' value="'+b+'"'+e+"/>")},tRequire:function(a){var b="data-bind-"+this.data.id+'="require"';return this.tItem('<label class="setting-check"><input type="checkbox" data-true-value="（必填）"  data-false-value="" '+b+(this.data.require?"checked":"")+" />必填</label>")},tDataType:function(){var a="data-bind-"+this.data.id+'="datetype"';return this.tItem(['<label class="setting-radio"><input type="radio" name="datetype" '+a+' value="datetime" '+("datetime"==this.data.datetype?"checked":"")+" />年-月-日 时:分</label>",'<label class="setting-radio"><input type="radio" name="datetype" '+a+' value="date" '+("date"==this.data.datetype?"checked":"")+" />年-月-日</label>"].join(""));
},tItem:function(a){return'<div class="setting-item">'+a+"</div>"},tOption:function(a,b){return['<div class="setting-option" data-index="'+b+'">','<input type="text" class="setting-text" data-model="options" value="'+a+'" />','<a class="option-delete"  data-model="option-delete"></a>','<a class="option-add"  data-model="option-add"></a>',"</div>"].join("")},tTextarea:function(a,b,c){var d="data-bind-"+this.data.id+'="'+a+'"';return this.tItem("<textarea "+d+' class="setting-text '+(c?"error":"")+'">'+b+"</textarea>")},tIcon:function(a){for(var b=[],c="data-bind-"+this.data.id+'="'+a+'"',d=0;d<this.data.icons.length;d++)b.push("<span "+(this.data.curIcon==d+1?"class=active":"")+'><img src="./design/images/app/'+this.data.icons[d]+'" '+c+' data-value="'+(d+1)+'" /></span>');return'<div class="setting-icon" data-role="curIconWrap">'+b.join("")+"</div>"},createTag:function(a,b,c,e){this[a]=d.create(b),c&&this[a].classList.add(c),e&&e.appendChild(this[a])}},b.Templates=e}),define("config/config",[],function(a,b,c){var d="http://";d+=-1!==window.location.host.indexOf("css.tianyuyun.cn")?"116.211.105.45:20013":"10.8.10.55:8080";var e={preview:"php/preview.php",template:"php/template.php",save:"server/save.php",file:"../server/file.php",submit:"../server/submit.php",getApprover:d+"/friendcircle/audit/qteacher",designDataPath:"php/data/",mobileDataPath:"../php/data/"};c.exports={Path:e}});